(this["webpackJsonpmodest-read"]=this["webpackJsonpmodest-read"]||[]).push([[9],{143:function(e,t,n){"use strict";n.r(t);var i=n(3),o=n(0),a=n(1),c=n(34),s=n(41),r=n(62);const l=Object(r.a)("ModestKeep2","current-file");function d(){return Object(r.c)("file",l)}async function u(e){const t=await d();(null===t||void 0===t?void 0:t.name)!==e.name&&Object(r.f)("file",e,l)}var b=n(38),m=n(32),v=n(13),f=n(48),h=n(40),p=n(74),w=(n(86),n.p+"static/media/ring.a86521a9.svg");var j=function(){return Object(i.jsx)("div",{className:"viewer-spinner-mask",children:Object(i.jsx)("img",{src:w,alt:""})})};n(87);var g=function({file:e,loading:t,notification:n,dismissNotification:o,handleFileUpload:a,loadPreviewFile:c}){return Object(i.jsxs)("div",{className:"viewer-file-preview-container",children:[Object(i.jsx)(h.a,{}),Object(i.jsxs)("div",{className:"viewer-file-preview",children:["negative"===(null===n||void 0===n?void 0:n.type)&&Object(i.jsx)(f.a,{notification:n,margin:"bottom",dismiss:o}),Object(i.jsxs)(p.a,{file:e,children:[Object(i.jsx)(v.b,{to:"/",className:"btn icon-btn",title:"Back to files",children:Object(i.jsx)(m.a,{name:"bookshelf",size:"24px"})}),Object(i.jsxs)("label",{className:"btn viewer-file-preview-import-btn",children:[Object(i.jsx)("input",{type:"file",onChange:a,className:"sr-only",accept:"application/pdf, application/epub+zip"}),Object(i.jsx)("span",{children:"Select File"})]})]}),"warning"===(null===n||void 0===n?void 0:n.type)&&Object(i.jsxs)("div",{className:"viewer-file-preview-warning",children:[Object(i.jsxs)("div",{className:"viewer-file-preview-warning-main",children:[Object(i.jsx)(m.a,{name:"info",className:"viewer-file-preview-warning-icon",size:"24px"}),Object(i.jsx)("p",{className:"viewer-file-preview-warning-message",children:n.value})]}),Object(i.jsxs)("div",{className:"viewer-file-preview-warning-bottom",children:[Object(i.jsx)("button",{className:"btn text-btn viewer-file-preview-warning-btn",onClick:o,children:"No"}),Object(i.jsx)("button",{className:"btn viewer-file-preview-warning-btn",onClick:c,children:"Yes"})]})]}),t&&Object(i.jsx)(j,{})]})]})},x=n(47);n(88);var O=function({file:e}){return Object(i.jsxs)(x.a,{toggle:{content:Object(i.jsx)(m.a,{name:"info"}),title:"Information",className:"btn icon-btn icon-btn-alt"},body:{className:"file-info"},children:[Object(i.jsx)("div",{className:"file-info-image-container",children:Object(i.jsx)("img",{src:e.coverImage,className:"file-info-image",alt:""})}),Object(i.jsxs)("div",{className:"file-info-items",children:[function(){let t="";return e.title?(t=e.title,e.author&&(t+=` by ${e.author}`)):t=e.name,Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("div",{className:"file-info-item file-info-title"+(t===e.name?" filename":""),children:t}),t!==e.name&&Object(i.jsx)("div",{className:"file-info-item file-info-filename",children:e.name})]})}(),Object(i.jsxs)("div",{className:"file-info-item file-info-secondary",children:[Object(i.jsxs)("span",{children:[e.pageCount," pages"]}),Object(i.jsx)("span",{children:e.sizeString}),Object(i.jsx)("span",{children:e.type})]})]})]})};n(89);var y=function({file:e,filePreferences:t,setViewerSettings:n,updateFileSavePreference:a,handleFileUpload:c,exitViewer:s}){const[r,l]=Object(o.useState)((()=>Object(b.b)())),d=Object(o.useRef)(!1),u=Object(o.useRef)(e.scrollTop),v=Object(o.useRef)(e.scrollTop>0),f=Object(o.useRef)(null),h=Object(o.useRef)(0),p=Object(o.useRef)(!1),w=Object(o.useRef)(!1),j=Object(o.useRef)(!1),g=Object(o.useCallback)((function(){if(p.current)return;p.current=!0,requestAnimationFrame((()=>{const{scrollTop:e}=document.documentElement;if(e>u.current)d.current?d.current=!1:j.current||L();else if(!e||h.current>100)E();else{const t=u.current-e;h.current+=t}u.current=e,p.current=!1}))}),[e.viewMode]),y=Object(o.useCallback)((function(){if(p.current)return;p.current=!0,requestAnimationFrame((()=>{const{scrollTop:t}=document.documentElement;t<80?"multi"===e.viewMode&&E():v.current?L():"multi"===e.viewMode&&E(),p.current=!1}))}),[e.viewMode]);function E(){var e;(null===(e=f.current)||void 0===e?void 0:e.classList.contains("hidden"))&&(h.current=0,f.current.classList.remove("hidden"),setTimeout((()=>{f.current.classList.remove("hiding")}),200))}function L(){var e;(null===(e=f.current)||void 0===e?void 0:e.classList.contains("hidden"))||(h.current=0,f.current.classList.add("hiding"),setTimeout((()=>{f.current.classList.add("hidden")}),200))}function N(e){w.current||(w.current=!0,requestAnimationFrame((()=>{e.clientY<80&&e.clientX<document.documentElement.clientWidth?(j.current=!0,f.current.classList.contains("hidden")&&(f.current.classList.remove("hidden"),setTimeout((()=>{f.current.classList.remove("hiding")}),200))):j.current=!1,w.current=!1})))}function k({target:t}){t.closest(".viewer-toolbar")||t.closest(".btn")||t.closest("#js-viewer-outline")||(d.current=!1,"multi"===e.viewMode&&document.documentElement.scrollTop<40?v.current=!v.current:f.current.classList.contains("hidden")?(v.current=!1,E()):(v.current=!0,L()))}function T({target:e}){var t,i;t=e.name,i=e.checked,n(t,i),l({...r,[t]:i}),Object(b.c)(t,i)}return Object(o.useEffect)((()=>{if("epub"===e.type)return;return matchMedia("only screen and (hover: none) and (pointer: coarse)").matches?(f.current.classList.toggle("hiding",e.scrollTop>0),f.current.classList.toggle("hidden",e.scrollTop>0),window.addEventListener("pointerup",k),window.addEventListener("scroll",y),()=>{window.removeEventListener("pointerup",k),window.removeEventListener("scroll",y)}):(window.addEventListener("scroll",g),window.addEventListener("mousemove",N),()=>{window.removeEventListener("scroll",g),window.removeEventListener("mousemove",N)})}),[g,y]),Object(i.jsxs)("div",{className:"viewer-toolbar"+(r.keepToolbarVisible?" keep-visible":""),ref:f,children:[Object(i.jsxs)("div",{className:"view-toolbar-side",children:[Object(i.jsx)(O,{file:e}),Object(i.jsx)("button",{id:"js-viewer-outline-toggle-btn",className:"btn icon-btn viewer-outline-toggle-btn",title:"Toggle outline",children:Object(i.jsx)(m.a,{name:"outline"})}),Object(i.jsxs)("div",{className:"viewer-toolbar-zoom",children:[Object(i.jsx)("button",{id:"js-viewer-zoom-out",className:"btn icon-btn viewer-toolbar-tool-btn",title:"Zoom out",children:Object(i.jsx)(m.a,{name:"minus"})}),Object(i.jsxs)("select",{id:"js-viewer-scale-select",className:"input viewer-toolbar-zoom-select",children:[Object(i.jsx)("option",{value:"custom",style:{display:"none"}}),"pdf"===e.type&&Object(i.jsx)("option",{value:"fit-width",children:"Fit Width"}),"pdf"===e.type&&Object(i.jsx)("option",{value:"fit-page",children:"Fit Page"}),Object(i.jsx)("option",{value:"0.5",children:"50%"}),Object(i.jsx)("option",{value:"0.75",children:"75%"}),Object(i.jsx)("option",{value:"1",children:"100%"}),Object(i.jsx)("option",{value:"1.5",children:"150%"}),Object(i.jsx)("option",{value:"2",children:"200%"}),Object(i.jsx)("option",{value:"3",children:"300%"}),Object(i.jsx)("option",{value:"4",children:"400%"})]}),Object(i.jsx)("button",{id:"js-viewer-zoom-in",className:"btn icon-btn viewer-toolbar-tool-btn",title:"Zoom in",children:Object(i.jsx)(m.a,{name:"plus"})})]})]}),Object(i.jsxs)("div",{className:"view-toolbar-side",children:[Object(i.jsxs)("div",{className:"viewer-toolbar-page",children:[Object(i.jsx)("button",{id:"js-viewer-previous-page",className:"btn icon-btn viewer-toolbar-tool-btn",children:Object(i.jsx)(m.a,{name:"arrow-up"})}),Object(i.jsxs)("div",{id:"js-viewer-page-input-container",className:"viewer-toolbar-page-input-container",children:[Object(i.jsx)("input",{id:"js-viewer-page-input",type:"text",inputMode:"numeric",className:"input viewer-toolbar-page-input"}),Object(i.jsx)("span",{})]}),Object(i.jsx)("button",{id:"js-viewer-next-page",className:"btn icon-btn viewer-toolbar-tool-btn",children:Object(i.jsx)(m.a,{name:"arrow-down"})})]}),Object(i.jsxs)(x.a,{toggle:{content:Object(i.jsx)(m.a,{name:"dots-vertical"}),title:"More",className:"btn icon-btn icon-btn-alt"},body:{className:"viewer-toolbar-dropdown"},children:[Object(i.jsx)("div",{className:"viewer-toolbar-dropdown-group",children:Object(i.jsxs)("label",{className:"btn icon-text-btn dropdown-btn viewer-toolbar-dropdown-btn",children:[Object(i.jsx)(m.a,{name:"upload"}),Object(i.jsx)("span",{children:"Load File"}),Object(i.jsx)("input",{type:"file",onChange:c,className:"sr-only",accept:"application/pdf, application/epub+zip"})]})}),"pdf"===e.type&&Object(i.jsx)("div",{className:"viewer-toolbar-dropdown-group",children:Object(i.jsxs)("button",{id:"js-viewer-rotate-btn",className:"btn icon-text-btn dropdown-btn viewer-toolbar-dropdown-btn",children:[Object(i.jsx)(m.a,{name:"rotate"}),Object(i.jsx)("span",{children:"Rotate pages"})]})}),Object(i.jsxs)("div",{id:"js-viewer-view-modes",className:"viewer-toolbar-dropdown-group",children:["pdf"===e.type&&Object(i.jsxs)("button",{className:"btn icon-text-btn dropdown-btn viewer-toolbar-dropdown-btn viewer-view-mode-btn","data-mode":"multi",children:[Object(i.jsx)(m.a,{name:"pages"}),Object(i.jsx)("span",{children:"Multi page"})]}),Object(i.jsxs)("button",{className:"btn icon-text-btn dropdown-btn viewer-toolbar-dropdown-btn viewer-view-mode-btn","data-mode":"single",children:[Object(i.jsx)(m.a,{name:"page"}),Object(i.jsx)("span",{children:"Single page"})]}),"epub"===e.type&&Object(i.jsxs)("button",{className:"btn icon-text-btn dropdown-btn viewer-toolbar-dropdown-btn viewer-view-mode-btn","data-mode":"spread",children:[Object(i.jsx)(m.a,{name:"spread"}),Object(i.jsx)("span",{children:"Spread page"})]})]}),"epub"===e.type&&Object(i.jsxs)("div",{id:"js-viewer-themes",className:"viewer-toolbar-dropdown-group viewer-themes-container",children:[Object(i.jsx)("div",{className:"viewer-themes-title",children:"Themes"}),Object(i.jsxs)("div",{className:"viewer-themes",children:[Object(i.jsx)("button",{className:"btn viewer-theme-btn black","data-theme":"black",children:"A"}),Object(i.jsx)("button",{className:"btn viewer-theme-btn white","data-theme":"white",children:"A"}),Object(i.jsx)("button",{className:"btn viewer-theme-btn grey","data-theme":"grey",children:"A"}),Object(i.jsx)("button",{className:"btn viewer-theme-btn orange","data-theme":"orange",children:"A"})]})]}),Object(i.jsxs)("div",{className:"viewer-toolbar-dropdown-group viewer-toolbar-settings",children:["pdf"===e.type&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("label",{className:"viewer-toolbar-settings-item",children:[Object(i.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input",name:"invertColors",onChange:T,checked:r.invertColors}),Object(i.jsx)("div",{className:"checkbox",children:Object(i.jsx)("div",{className:"checkbox-tick"})}),Object(i.jsx)("span",{className:"checkbox-label",children:"Invert page colors."})]}),Object(i.jsxs)("label",{className:"viewer-toolbar-settings-item",children:[Object(i.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input",name:"keepToolbarVisible",onChange:T,checked:r.keepToolbarVisible}),Object(i.jsx)("div",{className:"checkbox",children:Object(i.jsx)("div",{className:"checkbox-tick"})}),Object(i.jsx)("span",{className:"checkbox-label",children:"Keep toolbar visible."})]})]}),t.hideWarning&&Object(i.jsxs)("label",{className:"viewer-toolbar-settings-item",children:[Object(i.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input",onChange:a,checked:t.saveLoadedFile}),Object(i.jsx)("div",{className:"checkbox",children:Object(i.jsx)("div",{className:"checkbox-tick"})}),Object(i.jsx)("span",{className:"checkbox-label",children:"Save loaded file."})]})]}),Object(i.jsxs)("button",{className:"btn icon-text-btn viewer-toolbar-dropdown-btn",onClick:function(){window.removeEventListener("scroll",g),window.removeEventListener("mousemove",N),s()},title:"Exit",children:[Object(i.jsx)(m.a,{name:"exit"}),Object(i.jsx)("span",{children:"Exit"})]})]})]})]})};n(90);var E=function({message:e,filePreferences:t,saveFileLoadModalFile:n,hideFileLoadModal:a,hideFileLoadMessage:c}){const[s,r]=Object(o.useState)(!1),l=Object(o.useRef)(0);function d(e){const i={...t,hideWarning:s,saveLoadedFile:e};var o;e?n(i):a(i),s&&(o=i,localStorage.setItem("file-preferences",JSON.stringify(o)))}return Object(o.useEffect)((()=>{if(clearTimeout(l.current),e.duration)return l.current=setTimeout((()=>{c()}),e.duration),()=>{clearTimeout(l.current)}}),[e]),"negative"===e.type?Object(i.jsx)(f.a,{notification:e,className:"viewer-file-load-modal viewer-notification",dismiss:c}):"warning"!==e.type||t.hideWarning?null:Object(i.jsxs)("div",{className:"viewer-file-load-modal viewer-file-load-warning",children:[Object(i.jsxs)("div",{className:"viewer-file-load-warning-mesasge-container",children:[Object(i.jsx)(m.a,{name:"info",size:"24px"}),Object(i.jsx)("p",{className:"viewer-file-load-warning-mesasge",children:e.value})]}),Object(i.jsxs)("label",{className:"checkbox-container viewer-file-load-warning-checkbox-container",children:[Object(i.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input",onChange:function({target:e}){r(e.checked)},checked:s}),Object(i.jsx)("div",{className:"checkbox",children:Object(i.jsx)("div",{className:"checkbox-tick"})}),Object(i.jsx)("span",{className:"checkbox-label",children:"Don't show this message again."})]}),Object(i.jsxs)("div",{className:"viewer-file-load-warning-bottom",children:[Object(i.jsx)("button",{className:"btn text-btn",onClick:function(){d(!1)},children:"No"}),Object(i.jsx)("button",{className:"btn viewer-file-load-warning-btn",onClick:function(){d(!0)},children:"Yes"})]})]})};n(91);var L=function(){return Object(i.jsxs)("div",{className:"no-file-notice",children:[Object(i.jsx)(h.a,{}),Object(i.jsx)("p",{className:"no-file-notice-message",children:"File not found."}),Object(i.jsxs)(v.b,{to:"/",className:"btn icon-text-btn primary-btn",children:[Object(i.jsx)(m.a,{name:"bookshelf",size:"24px"}),Object(i.jsx)("span",{children:"Back to Files"})]})]})},N=n(145);class k{constructor(e,t,n){this.pdfDocument=e,this.pdfElement=t,this.url=n}navigateTo(e){this.goToDestination(e)}async goToDestination(e){let t=null;t="string"===typeof e?await this.pdfDocument.getDestination(e):e;const n=await this.pdfDocument.getPageIndex(t[0]);Object(c.k)(n+1,this.pdfElement.children,{keepToolbarVisible:Object(b.a)("keepToolbarVisible")})}getDestinationHash(e){if("string"===typeof e&&e.length)return this.getAnchorUrl(`#${escape(e)}`);if(Array.isArray(e)){const t=JSON.stringify(e);if(t.length)return this.getAnchorUrl(`#${escape(t)}`)}return this.getAnchorUrl("")}getAnchorUrl(e){return this.url+e}}var T=n(42);let S=null,C=null,M=!1,I=!1;async function F(e,t){const n=await e(),i=document.getElementById("js-viewer-outline"),o=document.getElementById("js-viewer-outline-toggle-btn");C=t,i.firstElementChild&&(o.removeEventListener("click",A),i.firstElementChild.remove()),i.classList.remove("visible"),i.removeEventListener("click",B),o.classList.toggle("visible",n.length),n.length&&o.addEventListener("click",A),S=n,I=!1,M=!1}async function A(){const e=document.getElementById("js-viewer-outline");if(M=!M,!I){const t=document.createElement("div");t.classList.add("viewer-outline"),e.append(t),z(S,t),e.addEventListener("click",B),I=!0}e.classList.toggle("visible",M)}function B(e){if(e.target===e.currentTarget)return M=!1,void e.currentTarget.classList.remove("visible");const{nodeName:t}=e.target;if("A"===t)return C(e.target.href),void e.preventDefault();const n=e.target.closest(".btn");"BUTTON"===(null===n||void 0===n?void 0:n.nodeName)&&(n.classList.toggle("rotated"),n.parentElement.nextElementSibling.classList.toggle("visible"))}function z(e,t){const n=new DocumentFragment;for(const i of e){const e=document.createElement("div"),t=`<a href="${i.href}" class="viewer-outline-link">${i.title}</a>`;if(e.classList.add("viewer-outline-item"),i.items.length?e.insertAdjacentHTML("beforeend",`\n        <div class="viewer-outline-item-title">\n          <button class="btn icon-btn viewer-outline-tree-toggle-btn">\n            <svg viewBox="0 0 24 24">\n                <path d="M7,10L12,15L17,10H7Z"/>\n            </svg>\n          </button>\n          ${t}\n        </div>\n      `):e.insertAdjacentHTML("beforeend",t),i.items.length){const t=document.createElement("div");t.classList.add("viewer-outline-inner-tree"),z(i.items,t),e.append(t)}n.append(e)}t.append(n)}const $=Object(b.b)(),P=1.3333;let D=null,V=null,W=null,R=null,H=[],U=[],J=null,K=null,q=0,Y=1,Z=!0,G=!1,X=!1,Q=!1,_=!1;async function ee(e,{metadata:t,blob:i,save:o=!0}){var a;D=await Promise.all([n.e(0),n.e(4),n.e(3)]).then(n.t.bind(null,57,7)),V=e,W=await Object(c.g)(i),R=t,(a=R).scale||(a.scale=He()),K=R.scale,q=t.rotation||0,Y=t.pageNumber||1,document.body.style.overscrollBehavior="none";const[r]=await Promise.all([De(W,t.rotation),"multi"===t.viewMode?Re(V,W,t):Ve(V,W,t)]);U=r,function(e){const t=document.getElementById("js-viewer-zoom-out"),n=document.getElementById("js-viewer-zoom-in");Se(e),t.addEventListener("click",Te),n.addEventListener("click",ke),document.getElementById("js-viewer-scale-select").addEventListener("change",Ie)}(K),function(){const e=document.getElementById("js-viewer-previous-page"),t=document.getElementById("js-viewer-next-page"),n=document.getElementById("js-viewer-page-input-container"),i=document.getElementById("js-viewer-page-input");n.lastElementChild.textContent=`of ${R.pageCount}`,Oe(Y),ye(Y),n.addEventListener("click",ae),e.addEventListener("click",Le),t.addEventListener("click",Ne),i.addEventListener("focus",ce),i.addEventListener("blur",se),i.addEventListener("keydown",re)}(),F(ve,fe),ne(o);const[l,d]=document.getElementById("js-viewer-view-modes").children;"multi"===t.viewMode?(H=Be(),l.classList.add("active"),window.addEventListener("scroll",ie),he()):(xe(Y),te(),d.classList.add("active"),window.addEventListener("scroll",oe),window.addEventListener("click",le)),window.addEventListener("keydown",de),window.addEventListener("keyup",ue),window.addEventListener("wheel",be,{passive:!1}),document.getElementById("js-viewer-rotate-btn").addEventListener("click",Ae),document.getElementById("js-viewer-view-modes").addEventListener("click",Fe),window.scrollTo(t.scrollLeft,t.scrollTop),o&&("have read"!==t.status&&(1===t.pageCount?t.status="have read":t.status="reading"),t.accessedAt=Date.now(),Object(s.d)(t),u(i)),Object(T.b)()}function te(){const e=document.getElementById("js-viewer-nav-previous-btn"),t=document.getElementById("js-viewer-nav-next-btn");e.classList.add("visible"),t.classList.add("visible"),e.addEventListener("click",Le),t.addEventListener("click",Ne)}function ne(e){Z=e}function ie(){Q||(Q=!0,requestAnimationFrame((()=>{const{scrollTop:e,scrollLeft:t}=document.documentElement,n=Y;R.scrollTop=e<0?0:e,R.scrollLeft=t,Y=function(e,t){for(let n=0;n<e.length-1;n+=1){const i=e[n],o=e[n+1],a=i.top+i.height/2,c=o.top+o.height/2;if(t>=a&&t<=c)return n+2}return 1}(H,R.scrollTop),R.pageNumber=Y,Z&&(clearTimeout(_),_=setTimeout((()=>{Object(s.d)(R)}),1e3)),Y!==n&&(Oe(Y),ye(Y)),Q=!1})))}function oe(){Q||(Q=!0,requestAnimationFrame((()=>{const{scrollTop:e,scrollLeft:t}=document.documentElement;R.scrollTop=e<0?0:e,R.scrollLeft=t,Z&&(clearTimeout(_),_=setTimeout((()=>{Object(s.d)(R)}),1e3)),Q=!1})))}function ae(e){e.target!==e.currentTarget.firstElementChild&&e.currentTarget.firstElementChild.focus()}function ce({target:e}){const{pageCount:t}=R,n=t<1e3?3:t.toString().length;e.style.width=`${n}ch`,e.select()}function se({target:e}){const{pageNumber:t,pageCount:n}=R;let i=parseInt(e.value,10);if(Number.isNaN(i))return e.value=t,void(e.style.width=`${t.toString().length}ch`);i<1?i=1:i>n&&(i=n),e.style.width=`${i.toString().length}ch`,Ee(i,!1)}function re(e){"Enter"===e.key&&e.target.blur()}function le({target:e}){"A"===e.nodeName&&e.classList.contains("internalLink")&&fe(e.href)}function de(e){if("INPUT"===e.target.nodeName)return;if(X=e.ctrlKey,e.ctrlKey)return"+"===e.key&&(ke(),e.preventDefault()),void("-"===e.key&&(Te(),e.preventDefault()));const{scrollWidth:t,offsetWidth:n}=document.documentElement;t<=n&&("ArrowLeft"===e.key?Ee(Y-1):"ArrowRight"===e.key&&Ee(Y+1))}function ue(e){X=e.ctrlKey}function be(e){X&&(e.preventDefault(),e.wheelDelta>0?ke():Te())}function me(e){const t=new k(W,V,window.location.href);return{title:e.title,href:t.getDestinationHash(e.dest),items:e.items.map(me)}}async function ve(){const e=await W.getOutline();return e?e.map(me):[]}async function fe(e){const t=new URL(e);if(t.origin!==window.location.origin)return;const n=t.hash.split("#"),i=unescape(n[n.length-1]);let o="";try{o=JSON.parse(i)}catch{o=await W.getDestination(i)}Ee(await W.getPageIndex(o[0])+1)}function he(){J&&J.disconnect();const e=H[Y-1].height/2;J=new IntersectionObserver(we,{rootMargin:`${e}px 0px`}),Array.from(V.children).forEach((e=>{J.observe(e)}))}function pe(){J&&(J.disconnect(),J=null)}function we(e){e.forEach((({isIntersecting:e,target:t})=>{!e||t.hasAttribute("data-loaded")&&!t.hasAttribute("data-rerender-needed")||(t.setAttribute("data-loaded","true"),je(t))}))}async function je(e){const t=parseInt(e.getAttribute("data-page-number"),10),{width:n,height:i}=ze(t-1,K.currentScale),o=document.createElement("canvas");let a=null,c=null;o.classList.add("viewer-page-canvas"),e.hasAttribute("data-rerender-needed")?([c,a]=e.children,a.innerHTML="",e.removeAttribute("data-rerender-needed")):(a=document.createElement("div"),a.classList.add("viewer-page-text"),e.appendChild(o),e.appendChild(a));const s=await W.getPage(t),r=s.getViewport({scale:K.currentScale,rotation:(q+s.rotate)%360});o.width=n,o.height=i,a.style.width=`${n}px`,a.style.height=`${i}px`,await s.render({canvasContext:o.getContext("2d"),enableWebGL:!0,viewport:r}).promise,requestAnimationFrame((async()=>{D.renderTextLayer({textContent:await s.getTextContent(),container:a,viewport:r,textDivs:[]}),async function(e,t,n){const i=await t.getAnnotations(),o=n.children[2];if(!i.length)return void(o&&o.remove());const a={page:t,annotations:i,viewport:e.clone({dontFlip:!0}),div:o,linkService:new k(W,V,window.location.href)};if(o&&"multi"===R.viewMode)D.AnnotationLayer.update(a);else{const e=document.createElement("div");e.className="viewer-annotation-layer",n.appendChild(e),a.div=e,D.AnnotationLayer.render(a),o&&o.remove()}}(r,s,e)})),c&&e.replaceChild(o,c)}function ge(e){for(const[t,n]of Object.entries(V.children)){const{width:i,height:o}=ze(t,e);if(n.style.width=`${i}px`,n.style.height=`${o}px`,n.hasAttribute("data-loaded")){const e=n.firstElementChild,{width:t}=e;i===t?(e.style.width="",e.style.height="",n.removeAttribute("data-rerender-needed")):(e.style.width=`${i}px`,e.style.height=`${o}px`,n.setAttribute("data-rerender-needed",!0))}}}function xe(e){!function(e){const{width:t,height:n}=ze(e-1,K.currentScale),i=V.firstElementChild;if(i.style.width=`${t}px`,i.style.height=`${n}px`,i.setAttribute("data-page-number",e),i.hasAttribute("data-loaded")){const e=i.firstElementChild;e.style.width=`${t}px`,e.style.height=`${n}px`,i.setAttribute("data-rerender-needed",!0)}}(e),je(V.firstElementChild),V.firstElementChild.setAttribute("data-loaded","true")}function Oe(e){const t=document.getElementById("js-viewer-page-input");t.value=e,t.style.width=`${e.toString().length}ch`}function ye(e){const t=document.getElementById("js-viewer-previous-page"),n=document.getElementById("js-viewer-next-page");1===e?t.disabled=!0:e===R.pageCount?n.disabled=!0:(t.disabled=!1,n.disabled=!1)}function Ee(e,t=!0){"multi"===R.viewMode?Object(c.k)(e,V.children,{keepToolbarVisible:$.keepToolbarVisible}):(Y=e,R.pageNumber=Y,xe(e),window.scrollTo(0,0),t&&Oe(e),ye(e),Z&&Object(s.d)(R))}function Le(){Ee(Y-1)}function Ne(){Ee(Y+1)}function ke(){Ce(Math.min(1.1*K.currentScale,13.333))}function Te(){Ce(Math.max(K.currentScale/1.1,.333325))}function Se(e){const t=document.getElementById("js-viewer-scale-select");t.value=e.name,t.firstElementChild.textContent=`${e.displayValue}%`}function Ce(e,t="custom"){const n=K.currentScale;if(K.name=t,K.currentScale=e,K.displayValue=Math.round(100*e/P),R.scale=K,"multi"===R.viewMode){const{top:t}=Object(c.f)(Y,V.children);ge(e),H=Be(),R.scrollTop=H[Y-1].top-t/n*e,R.scrollLeft=R.scrollLeft/n*e,he()}else xe(Y),R.scrollTop=R.scrollTop/n*e,R.scrollLeft=R.scrollLeft/n*e;Se(K),window.scrollTo(R.scrollLeft,R.scrollTop),Z&&Object(s.d)(R)}function Me(e){const t="single"===R.viewMode,{keepToolbarVisible:n}=$;return e-(n||1===Y||t?56:16)}async function Ie({target:e}){const{value:t}=e;let n=0;if("fit-width"===t){const{offsetWidth:e,scrollHeight:t,offsetHeight:i}=document.documentElement,{width:o,height:a}=await $e(W,{pageNumber:Y,rotation:q}),s=Me(i);let r=e-16,l=0;if(n=r/o,Math.round(n*o)>=r){const e=Math.round(n*a);t>i?"multi"===R.viewMode&&R.pageCount*e>i?l=0:e<s&&(l=Object(c.h)()):e>s&&(l=-Object(c.h)())}r+=l,n=r/o}else if("fit-page"===t){const{scrollWidth:e,offsetWidth:t,offsetHeight:i}=document.documentElement,{width:o,height:a}=await $e(W,{pageNumber:Y,rotation:q}),s=t-16;let r=Me(i),l=0;if(n=r/a,Math.round(n*a)>=r){const i=Math.round(n*o);e>t?i<s&&(l=Object(c.h)()):i>s&&(l=-Object(c.h)())}r+=l,n=r/a}else n=P*t;Ce(n,t)}async function Fe(e){const t=Object(c.c)("data-mode",e.target,e.currentTarget);if(!t)return;const{attrValue:n}=t;if(n===R.viewMode)return;const[i,o]=e.currentTarget.children;i.classList.toggle("active"),o.classList.toggle("active"),R.viewMode=n,V.innerHTML="","multi"===n?(await Re(V,W,R),H=Be(),Object(c.k)(Y,V.children,{keepToolbarVisible:$.keepToolbarVisible,scrollLeft:0}),he(),function(){const e=document.getElementById("js-viewer-nav-previous-btn"),t=document.getElementById("js-viewer-nav-next-btn");e.classList.remove("visible"),t.classList.remove("visible"),e.removeEventListener("click",Le),t.removeEventListener("click",Ne)}(),window.addEventListener("scroll",ie),window.removeEventListener("scroll",oe),window.removeEventListener("click",le)):(pe(),await Ve(V,W,R),xe(Y),window.scrollTo(0,0),te(),window.addEventListener("scroll",oe),window.addEventListener("click",le),window.removeEventListener("scroll",ie)),Z&&Object(s.d)(R)}function Ae(){const e=q+90;q=360===e?0:e,R.rotation=q,G=!G,"multi"===R.viewMode?(ge(K.currentScale),H=Be(),he(),Object(c.k)(Y,V.children,{keepToolbarVisible:$.keepToolbarVisible})):(xe(Y),window.scrollTo(0,0)),Z&&Object(s.d)(R)}function Be(){return Array.from(V.children).map((e=>({top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight})))}function ze(e,t){const n=U[e];let i=Math.floor(n.width*t),o=Math.floor(n.height*t);return G&&([i,o]=[o,i]),{width:i,height:o}}async function $e(e,{pageNumber:t,scale:n={currentScale:1},rotation:i=0}){const o=await e.getPage(t);return o.getViewport({scale:n.currentScale,rotation:i+o.rotate})}async function Pe(e,t){const{width:n,height:i}=await $e(e,t),o=document.createElement("div");return o.style.width=`${Math.floor(n)}px`,o.style.height=`${Math.floor(i)}px`,o.setAttribute("data-page-number",t.pageNumber),o.classList.add("viewer-page"),o}async function De(e,t){const n=[];for(let i=0;i<e.numPages;i+=1){const{width:o,height:a}=await $e(e,{pageNumber:i+1,rotation:t});n.push({width:o,height:a})}return n}async function Ve(e,t,n){const i=await Pe(t,n);e.appendChild(i)}async function We(e,t,n,i){const o=await Pe(i,{...t,pageNumber:e});n.appendChild(o)}async function Re(e,t,n){const i=new DocumentFragment,o=[];for(let a=0;a<t.numPages;a+=1)o.push(We(a+1,n,i,t));await Promise.all(o),e.appendChild(i)}function He(){return{name:"1",currentScale:P}}let Ue=null,Je=null,Ke=null,qe=null,Ye=null,Ze=0,Ge=!0,Xe="",Qe=null,_e="";async function et(e,{metadata:t,blob:i,save:o=!0}){const{default:a}=await Promise.all([n.e(0),n.e(1)]).then(n.bind(null,142));Ue=a(i),Ke=t,qe=t.scale||{name:"1",currentScale:1},Ye=e,Je=xt(t.viewMode),document.getElementById("js-viewer-themes").addEventListener("click",nt),function(e){const t=document.getElementById("js-viewer-zoom-out"),n=document.getElementById("js-viewer-zoom-in");ft(e),t.addEventListener("click",pt),n.addEventListener("click",ht),document.getElementById("js-viewer-scale-select").addEventListener("change",wt)}(qe),function(e,t){const n=document.getElementById("js-viewer-previous-page"),i=document.getElementById("js-viewer-next-page"),o=document.getElementById("js-viewer-page-input-container"),a=document.getElementById("js-viewer-page-input");lt(e),function(){const e=document.getElementById("js-viewer-nav-previous-btn"),t=document.getElementById("js-viewer-nav-next-btn");e.classList.add("visible"),t.classList.add("visible"),e.addEventListener("click",mt),t.addEventListener("click",vt)}(),o.lastElementChild.textContent=`of ${t}`,o.addEventListener("click",Ot),n.addEventListener("click",mt),i.addEventListener("click",vt),a.addEventListener("focus",yt),a.addEventListener("blur",Et),a.addEventListener("keydown",Lt)}(t.pageNumber,t.pageCount),function(e){const[t,n]=document.getElementById("js-viewer-view-modes").children;"single"===e?t.classList.add("active"):n.classList.add("active");document.getElementById("js-viewer-view-modes").addEventListener("click",gt)}(t.viewMode),F(bt,dt),await Ue.ready,t.storedPosition?await Ue.locations.load(t.storedPosition):(await Ue.locations.generate(1650),t.storedPosition=Ue.locations.save(),t.pageCount=Ue.locations.length()),t.pageNumber=t.location?Ue.locations.locationFromCfi(t.location)+1:1,Je.on("relocated",at),Je.on("keydown",ct),Je.on("click",st),Je.display(t.location),rt(o),window.addEventListener("keydown",Nt),window.addEventListener("dropdown-visible",tt),o&&("have read"!==t.status&&(1===t.pageCount?t.status="have read":t.status="reading"),t.accessedAt=Date.now(),Object(s.d)(t),u(i)),Object(T.b)()}function tt({detail:e}){Xe=e.id,Qe=e.hide}function nt(e){const t=Object(c.c)("data-theme",e.target,e.currentTarget);t&&(Ke.theme=t.attrValue,ot(),Ge&&(clearTimeout(Ze),Ze=setTimeout((()=>{Object(s.d)(Ke)}),1e3)))}function it(e){for(const n of e.document.styleSheets)for(const e of n.rules){var t;if((null===(t=e.style)||void 0===t?void 0:t.fontSize)&&"html"!==e.selectorText)if(e.style.fontSize.endsWith("pt")){const t=Math.round(1.3333*Number.parseFloat(e.style.fontSize))/16;e.style.fontSize=`${t}rem`}else if(e.style.fontSize.endsWith("px")){const t=Number.parseFloat(e.style.fontSize)/16;e.style.fontSize=`${t}rem`}else if(e.style.fontSize.endsWith("%")){const t=Number.parseFloat(e.style.fontSize)/100;e.style.fontSize=`${t}rem`}else if(e.style.fontSize.endsWith("em"))e.style.fontSize=`${Number.parseFloat(e.style.fontSize)}rem`;else{const t={"xx-small":"0.5625","x-small":"0.625",small:"0.8333",medium:"1",large:"1.125","x-large":"1.5","xx-large":"2","xxx-large":"3"};t[e.style.fontSize]&&(e.style.fontSize=`${t[e.style.fontSize]}rem`)}}}function ot(){const{theme:e}=Ke;if(!e)return;const t={black:{body:{color:"white","background-color":"black"}},white:{body:{color:"black","background-color":"white"}},grey:{body:{color:"white","background-color":"#1d1c1b"}},orange:{body:{color:"black","background-color":"#FBF0D9"}}};Je.getContents().forEach((e=>e.addStylesheetRules(t[Ke.theme]))),_e&&Ye.firstElementChild.classList.remove(`theme-${_e}`),Ye.firstElementChild.classList.add(`theme-${Ke.theme}`),_e=Ke.theme}function at(e){const{cfi:t,location:n,index:i}=e.start,o=n+1;Ke.location=t,Ke.pageNumber=Ue.locations.locationFromCfi(t)+1,lt(o),function(e,t,{location:n,index:i,atStart:o}){const a=document.getElementById("js-viewer-previous-page"),c=document.getElementById("js-viewer-next-page");o||0===n&&0===i?a.disabled=!0:e===t||"spread"===Ke.viewMode&&n+2===t?c.disabled=!0:(a.disabled=!1,c.disabled=!1)}(o,Ue.locations.length(),{location:n,index:i,atStart:e.atStart}),Ge&&(clearTimeout(Ze),Ze=setTimeout((()=>{Object(s.d)(Ke)}),1e3))}function ct(e){e.ctrlKey&&document.activeElement.blur()}function st(){Xe&&(Xe="",Qe())}function rt(e){Ge=e}function lt(e){const t=document.getElementById("js-viewer-page-input");t.value=e,t.style.width=`${e.toString().length}ch`}function dt(e){Je.display(e.split(/viewer\/.*?\//g)[1])}function ut(e){return{title:e.label,href:`${window.location.href}/${e.href}`,items:e.subitems.map(ut)}}async function bt(){const e=await Ue.loaded.navigation;return Array.isArray(e.toc)?e.toc.map(ut):[]}function mt(){Je.prev()}function vt(){Je.next()}function ft(e){const t=document.getElementById("js-viewer-scale-select");t.value=e.name,t.firstElementChild.textContent=`${e.displayValue}%`}function ht(){jt(Math.min(1.1*qe.currentScale,13.333))}function pt(){jt(Math.max(qe.currentScale/1.1,.333325))}async function wt({target:e}){const{value:t}=e;jt(t,t)}function jt(e,t="custom"){qe.name=t,qe.currentScale=e,qe.displayValue=Math.round(100*e),Ke.scale=qe,ft(qe),Je.themes.default({html:{"font-size":100*e+"% !important"}}),Ge&&Object(s.d)(Ke)}function gt(e){const t=Object(c.c)("data-mode",e.target,e.currentTarget);if(!t)return;const{attrValue:n}=t;if(n===Ke.viewMode)return;const[i,o]=e.currentTarget.children;i.classList.toggle("active"),o.classList.toggle("active"),Ke.viewMode=n,Ye.innerHTML="",Je.off("relocated",at),Je=xt(n),Je.on("relocated",at),Je.on("keydown",ct),Je.on("click",st),Je.display(Ke.location),Ge&&Object(s.d)(Ke)}function xt(e){const t={flow:"paginated",height:document.documentElement.offsetHeight-40};"single"===e&&(t.spread="none");const n=Ue.renderTo(Ye,t);return n.hooks.content.register(it),n.hooks.content.register(ot),n.themes.default({html:{"font-size":100*qe.currentScale+"% !important"},"::selection":{"background-color":"hsla(260, 48%, 52%, 0.4)"}}),n}function Ot(e){e.target!==e.currentTarget.firstElementChild&&e.currentTarget.firstElementChild.focus()}function yt({target:e}){const{pageCount:t}=Ke,n=t<1e3?3:t.toString().length;e.style.width=`${n}ch`,e.select()}function Et({target:e}){const{location:t,pageCount:n}=Ke,i=Ue.locations.locationFromCfi(t);let o=parseInt(e.value,10);if(Number.isNaN(o))return e.value=i,void(e.style.width=`${i.toString().length}ch`);o<1?o=1:o>n&&(o=n);const a=Ue.locations.cfiFromLocation(o);e.style.width=`${o.toString().length}ch`,Je.display(a)}function Lt(e){"Enter"===e.key&&e.target.blur()}function Nt(e){if("INPUT"!==e.target.nodeName)return e.ctrlKey?("+"===e.key&&(ht(),e.preventDefault()),void("-"===e.key&&(pt(),e.preventDefault()))):void("ArrowLeft"===e.key?mt():"ArrowRight"===e.key&&vt())}n(92);t.default=function(){var e;const t=Object(a.f)(),{id:r}=Object(a.g)(),[l,v]=Object(o.useState)({}),[f,h]=Object(o.useState)((()=>JSON.parse(localStorage.getItem("file-preferences"))||{})),[p,w]=Object(o.useState)((()=>Object(b.b)())),[x,O]=Object(o.useState)(null),k=Object(o.useRef)(null),S=Object(o.useRef)(!1),C=Object(o.useCallback)((function(e){if(e.preventDefault(),e.dataTransfer.files.length){const[t]=e.dataTransfer.files;B(t)}}),[l,f,x]);function M(e){e.preventDefault()}function I(e){const[t]=e.target.files;B(t),e.target.value=""}function F(e,t){var n;S.current=!0,(n=t.metadata).type||(n.type="pdf"),"pdf"===t.metadata.type?ee(e,t):"epub"===t.metadata.type&&et(e,t)}function A(){l.file&&("pdf"===l.file.type?(pe(),V&&(V.innerHTML=""),W=null,document.body.style.overscrollBehavior="",Object(T.c)(),window.removeEventListener("scroll",ie),window.removeEventListener("scroll",oe),window.removeEventListener("keydown",de),window.removeEventListener("keyup",ue),window.removeEventListener("wheel",be,{passive:!1})):"epub"===l.file.type&&(Ye&&(Ye.innerHTML=""),Object(T.c)(),window.removeEventListener("keydown",Nt),window.removeEventListener("dropdown-visible",tt)))}async function B(e){l.file&&(["pdf","epub"].includes(l.file.type)?e.name===l.file.name?l.filePreviewVisible?(F(k.current,{blob:e,metadata:l.file,save:!0}),$(),v({file:l.file})):O({type:"negative",value:"File is already loaded.",duration:4e3}):l.filePreviewVisible?O({file:e,type:"warning",value:"File does not match currently loaded file.\nDo you want to load it anyway?"}):z({file:e}):O({type:"negative",value:"File format is not supported.",duration:4e3}))}async function z({file:e}){v({...l,loading:!0});let i=await async function(e){return(await Object(s.c)()).find((({name:t})=>t===e.name))}(e),o=!0;if(!i){const t=e.name.slice(e.name.lastIndexOf(".")+1);"pdf"===t?i=await async function(e){W=await Object(c.g)(e);const[t,n]=await Promise.all([W.getMetadata(),Object(c.i)(W)]);return{...Object(c.j)(t),id:Object(N.a)(),name:e.name,type:"pdf",createdAt:Date.now(),scale:He(),size:e.size,sizeString:Object(c.e)(e.size),pageNumber:1,pageCount:W.numPages,viewMode:"multi",coverImage:n}}(e):"epub"===t&&(i=await async function(e){const{default:t}=await Promise.all([n.e(0),n.e(1)]).then(n.bind(null,142));Ue=t(e),await Ue.ready;const[i,o,a]=await Promise.all([Ue.loaded.metadata,Ue.locations.generate(1650),Object(c.d)(Ue)]),s={storedPosition:JSON.stringify(o),coverImage:a,id:Object(N.a)(),name:e.name,type:"epub",createdAt:Date.now(),scale:{name:"1",currentScale:1},size:e.size,sizeString:Object(c.e)(e.size),pageNumber:1,pageCount:Ue.locations.length(),viewMode:"single"};return i.title&&(s.title=i.title),i.creator&&(s.author=i.creator),s}(e)),l.filePreviewVisible||(f.hideWarning?o=f.saveLoadedFile:(o=!1,O({file:e,type:"warning",value:"Do you want to save this file?"})))}!function(e,t){S.current&&A(),F(e,t)}(k.current,{metadata:i,blob:e,save:o}),t.replace({pathname:`/viewer/${i.id}`,state:!0}),Object(c.l)(i.name),v({file:i})}function $(){O(null)}function P(e){var t;t=e.saveLoadedFile,"pdf"===l.file.type?ne(t):"epub"===l.file.type&&rt(t),h(e),$()}return Object(o.useLayoutEffect)((()=>A()),[]),Object(o.useLayoutEffect)((()=>{!async function(){if(t.location.state)return;const e=await Object(s.b)(r);if(e){const t=await d();e.type||(e.type="pdf"),t&&t.name===e.name?(F(k.current,{blob:t,metadata:e}),v({file:e})):v({file:e,filePreviewVisible:!0}),Object(c.l)(e.name)}else v({error:!0}),Object(c.l)("Error")}()}),[r]),Object(o.useEffect)((()=>(window.addEventListener("drop",C),window.addEventListener("dragover",M),()=>{window.removeEventListener("drop",C),window.removeEventListener("dragover",M)})),[C]),Object(o.useEffect)((()=>{if(l.file){if("single"===l.file.viewMode&&"pdf"===l.file.type){if(matchMedia("only screen and (hover: none) and (pointer: coarse)").matches&&!p.keepToolbarVisible)return void k.current.classList.remove("offset")}k.current.classList.add("offset")}}),[p.keepToolbarVisible,l.file]),l.error?Object(i.jsx)(L,{}):Object(i.jsxs)(i.Fragment,{children:[l.filePreviewVisible?Object(i.jsx)(g,{file:l.file,loading:l.loading,notification:x,dismissNotification:$,handleFileUpload:I,loadPreviewFile:function(){z(x),$()}}):x?Object(i.jsx)(E,{message:x,filePreferences:f,saveFileLoadModalFile:function(e){var t,n;t=x.file,n=l.file,Object(s.d)(n),u(t),P(e)},hideFileLoadModal:P,hideFileLoadMessage:$}):null,l.file&&!l.filePreviewVisible&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(y,{file:l.file,filePreferences:f,setViewerSettings:function(e,t){w({...p,[e]:t})},updateFileSavePreference:function({target:e}){const t={...f,saveLoadedFile:e.checked};var n;h(t),n=t,localStorage.setItem("file-preferences",JSON.stringify(n))},handleFileUpload:I,exitViewer:function(){t.push({pathname:"/"}),A()}}),l.loading&&Object(i.jsx)(j,{})]}),Object(i.jsx)("div",{className:"viewer offset"+("pdf"===(null===(e=l.file)||void 0===e?void 0:e.type)&&p.invertColors?" invert":""),ref:k}),Object(i.jsx)("div",{id:"js-viewer-outline",className:"viewer-outline-container"}),Object(i.jsx)("button",{id:"js-viewer-nav-previous-btn",className:"btn icon-btn viewer-navigation-btn previous",children:Object(i.jsx)(m.a,{name:"chevron-left"})}),Object(i.jsx)("button",{id:"js-viewer-nav-next-btn",className:"btn icon-btn viewer-navigation-btn next",children:Object(i.jsx)(m.a,{name:"chevron-right"})})]})}},42:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return r}));const i=JSON.parse(localStorage.getItem("reading-time"))||{};let o=0,a=0;function c(){o=Date.now(),a=setInterval(l,1e4)}function s(){clearInterval(a),l()}function r(){return i}function l(){const e=new Date,t=e.getFullYear(),n=e.getMonth(),a=Date.now()-o;i[t]||(i[t]=new Array(12).fill(0)),i[t][n]+=Math.round(a/1e3),o=Date.now(),localStorage.setItem("reading-time",JSON.stringify(i))}},86:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){}}]);