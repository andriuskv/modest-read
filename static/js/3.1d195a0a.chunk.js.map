{"version":3,"sources":["components/Icon.js","utils.js","components/BannerImage/index.js","components/BannerImage/BannerImage.js","assets/icon-text.svg","components/Dropdown/index.js","components/Dropdown/Dropdown.js","components/Notification/index.js","components/Notification/Notification.js","services/settingsService.js","../node_modules/idb-keyval/dist/idb-keyval.mjs","services/fileIDBService.js","components/FileCard/index.js","components/FileCard/FileCard.js","../node_modules/uuid/dist/esm-browser/rng.js","../node_modules/uuid/dist/esm-browser/regex.js","../node_modules/uuid/dist/esm-browser/stringify.js","../node_modules/uuid/dist/esm-browser/validate.js","../node_modules/uuid/dist/esm-browser/v4.js","components/Viewer/FilePreview/index.js","components/Viewer/FilePreview/FilePreview.js","components/Viewer/FileInfo/index.js","components/Viewer/FileInfo/FileInfo.js","components/Viewer/NoFileNotice/index.js","components/Viewer/NoFileNotice/NoFileNotice.js","components/Viewer/index.js","components/Viewer/Viewer.js"],"names":["Icon","name","title","size","className","style","icons","grid","list","trash","settings","menu","close","upload","bookshelf","book","plus","minus","info","exit","width","height","viewBox","d","setDocumentTitle","document","classNames","join","trimEnd","async","pageToDataURL","pdf","page","getPage","canvas","createElement","viewport","getViewport","scale","DEFAULT_SCALE","render","canvasContext","getContext","promise","toDataURL","getPdfInstance","file","pdfjs","arrayBuffer","getDocument","Uint8Array","parseMetadata","metadata","data","Title","Author","author","getFileSizeString","bytes","suffixes","l","length","toFixed","Math","round","BannerImage","src","iconFull","alt","module","exports","Dropdown","container","toggle","body","children","state","setState","useState","id","uuidv4","memoizedWindowClickHandler","useCallback","target","closestContainer","closest","hideDropdown","isMounted","current","visible","reveal","window","removeEventListener","useRef","drop","useEffect","viewportHeight","documentElement","offsetHeight","getBoundingClientRect","onTop","top","onClick","currentTarget","addEventListener","bottom","content","ref","Notification","notification","expandable","margin","dismiss","expanded","setExpanded","type","flashing","value","setTimeout","transform","JSON","parse","localStorage","getItem","showCategories","layoutType","invertColors","keepToolbarVisible","getSettings","setSetting","key","setItem","stringify","Store","constructor","dbName","storeName","this","_dbp","Promise","resolve","reject","openreq","indexedDB","open","onerror","error","onsuccess","result","onupgradeneeded","createObjectStore","_withIDBStore","callback","then","db","transaction","oncomplete","onabort","objectStore","store","getDefaultStore","fetchIDBFiles","keys","openKeyCursor","openCursor","call","push","continue","all","map","fetchIDBFile","sortFiles","catch","e","console","log","req","get","saveFile","snippet","put","set","deleteIDBFile","delete","del","files","reading","rest","reduce","arr","status","sort","a","b","accessedAt","sortReadingFiles","concat","createdAt","sortRestFiles","FileCard","showLink","to","coverImage","sizeString","pageNumber","pageCount","left","getRandomValues","crypto","bind","msCrypto","rnds8","rng","Error","validate","uuid","REGEX","test","byteToHex","i","toString","substr","offset","arguments","undefined","toLowerCase","TypeError","v4","options","buf","rnds","random","FilePreview","dismissNotification","handleFileUpload","loadNewFile","onChange","accept","FileInfo","NoFileNotice","Viewer","history","useHistory","useParams","setPageNumber","setScale","fileLoadMessage","setFileLoadMessage","setSettings","pdfRef","toolbarRef","toolbarScrollOffset","pageRendering","pendingPages","observer","scrollTimeout","updatingPageNumber","updatingPages","scrollDirection","ctrlPressed","memoizedScrollHandler","requestAnimationFrame","scrollTop","scrollLeft","oldPageNumber","scrollDiff","views","view","view2","offset2","getVisiblePageNumber","classList","contains","add","revealToolbar","clearTimeout","memoizedMouseMoveHandler","event","clientY","clientX","clientWidth","remove","memoizedWheelHandler","preventDefault","wheelDelta","zoomIn","zoomOut","memoizedKeyUpHandler","ctrlKey","memoizedKeyDownHandler","nodeName","scrollWidth","offsetWidth","previousPage","nextPage","getPageDimensions","dimensions","numPages","renderEmptyPage","fragmenet","div","floor","setAttribute","appendChild","renderEmptyPages","fragment","DocumentFragment","promises","loadFile","newFile","pdfInstance","stateFile","maxWidth","maxHeight","pageDimensions","findBiggestDimensions","filePreviewVisible","instance","scrollTo","Date","now","handleSelect","newScale","max","min","scrollToPage","handleInputKeydown","blur","handleInputBlur","number","parseInt","Number","isNaN","handleInputChange","handleInputClick","firstElementChild","focus","handleInputFocus","select","execFuncOnPageElement","element","getAttribute","offsetTop","handleSettingChange","checked","location","overscrollBehavior","init","passive","scaleValue","index","Object","entries","pageDimension","w","h","hasAttribute","removeAttribute","updatePages","Array","from","offsetLeft","pagesInViewport","count","ceil","getVisiblePageCount","updatePagesWithNewScale","disconnect","IntersectionObserver","forEach","isIntersecting","renderPageContent","textLayerDiv","oldCanvas","lastElementChild","innerHTML","enableWebGL","textContent","getTextContent","textDivs","replaceChild","pop","shift","rootMargin","observe","endsWith","find","getMetadata","replace","pathname","disabled","display","inputMode","onBlur","onFocus","onKeyDown"],"mappings":"iIAAA,sDAEe,SAASA,GAAK,KAAEC,EAAF,MAAQC,EAAR,KAAeC,EAAO,OAAtB,UAA8BC,EAA9B,MAAyCC,EAAQ,KAC5E,MAAMC,EAAQ,CACZC,KAAO,uFACPC,KAAO,8EACPC,MAAQ,oFACRC,SAAW,84BACXC,KAAO,iDACPC,MAAQ,gHACR,gBAAkB,iNAClBC,OAAS,iDACT,eAAiB,2MACjB,eAAiB,sHACjBC,UAAY,0EACZC,KAAO,kKACP,YAAc,gbACd,qBAAuB,wUACvB,kBAAoB,yJACpB,YAAc,uBACd,MAAU,6OACVC,KAAO,4CACPC,MAAQ,qBACR,WAAa,yEACb,aAAe,0EACfC,KAAO,0MACPC,KAAO,0LAIT,OAFAd,EAAQ,IAAKA,EAAOe,MAAOjB,EAAMkB,OAAQlB,GAGvC,yBAAKmB,QAAQ,YAAYlB,UAAWA,EAAWC,MAAOA,GACnDH,GAAS,+BAAQA,GAClB,0BAAMqB,EAAGjB,EAAML,Q,6BCjCrB,SAASuB,EAAiBtB,GACxBuB,SAASvB,MAAWA,EAAF,gBAGpB,SAASwB,KAAcA,GACrB,OAAOA,EAAWC,KAAK,KAAKC,UAG9BC,eAAeC,EAAcC,GAC3B,MACMC,QAAaD,EAAIE,QAAQ,GACzBC,EAAST,SAASU,cAAc,UAGtC,IAAIC,EAAWJ,EAAKK,YAAY,CAAEC,MALZ,KAiBtB,OAVIF,EAAShB,MAJI,IAKfgB,EAAWJ,EAAKK,YAAY,CAAEC,MAAOC,KAA2BH,EAAShB,QAElEgB,EAASf,OANA,MAOhBe,EAAWJ,EAAKK,YAAY,CAAEC,MAAOC,GAA4BH,EAASf,UAE5Ea,EAAOd,MAAQgB,EAAShB,MACxBc,EAAOb,OAASe,EAASf,aAEnBW,EAAKQ,OAAO,CAAEC,cAAeP,EAAOQ,WAAW,MAAON,aAAYO,QACjET,EAAOU,UAAU,aAAc,IAGxCf,eAAegB,EAAeC,EAAMC,GAClC,MAAMC,QAAoBF,EAAKE,cAC/B,OAAOD,EAAME,YAAY,IAAIC,WAAWF,IAAcL,QAGxD,SAASQ,EAAcC,GACrB,MAAMC,EAAO,GASb,OAPID,EAASlC,KAAKoC,QAChBD,EAAKnD,MAAQkD,EAASlC,KAAKoC,OAGzBF,EAASlC,KAAKqC,SAChBF,EAAKG,OAASJ,EAASlC,KAAKqC,QAEvBF,EAGT,SAASI,EAAkBC,GACzB,MAAMC,EAAW,CAAC,IAAK,KAAM,KAAM,MACnC,IAAIxD,EAAOuD,EACPE,EAAI,EAER,KAAOA,EAAID,EAASE,UACd1D,EAAO,MAITA,GAAQ,IAEVyD,GAAK,EAGP,OADAzD,EAAOyD,EAAI,EAAIzD,EAAK2D,QAAQ,GAAKC,KAAKC,MAAM7D,GACpC,GAAEA,KAAQwD,EAASC,KA9D7B,6M,wECCeK,ICGA,WACb,OAAO,yBAAKC,IAAKC,IAAU/D,UAAU,eAAegE,IAAI,O,gBCL1DC,EAAOC,QAAU,IAA0B,uC,mFCC5BC,ICGA,UAAkB,UAAEC,EAAF,OAAaC,EAAb,KAAqBC,EAArB,SAA2BC,IAC1D,MAAOC,EAAOC,GAAYC,mBAAS,CAAEC,GAAIC,gBACnCC,EAA6BC,uBA6CnC,UAA2B,OAAEC,IAC3B,MAAMC,EAAmBD,EAAOE,QAAQ,uBACxC,IAAIC,GAAe,GAEC,OAAhBF,QAAgB,IAAhBA,OAAA,EAAAA,EAAkBL,MAAOH,EAAMG,KAE/BO,GADEH,EAAOE,QAAQ,0BAIFF,EAAOE,QAAQ,MAAQF,EAAOE,QAAQ,mBAIrDC,IACEC,EAAUC,SACZX,EAAS,CAAEE,GAAIH,EAAMG,GAAIU,SAAS,EAAOC,QAAQ,IAEnDC,OAAOC,oBAAoB,QAASX,MA9D0B,CAACL,EAAMG,KACnEQ,EAAYM,kBAAO,GACnBC,EAAOD,iBAAO,MAgEpB,OA9DAE,oBAAU,KACRR,EAAUC,SAAU,EAEb,KACLD,EAAUC,SAAU,EACpBG,OAAOC,oBAAoB,QAASX,KAErC,CAACA,IAEJc,oBAAU,KACR,GAAInB,EAAMc,OAAQ,CAChB,MAAMM,EAAiBvE,SAASwE,gBAAgBC,aAC1C7E,EAASyE,EAAKN,QAAQW,wBAAwB9E,OAEpDwD,EAAS,IACJD,EACHwB,MAAOxB,EAAMyB,IAAMhF,EAAS2E,EAC5BP,SAAS,MAGZ,CAACb,EAAMc,SA2CR,yBAAKX,GAAIH,EAAMG,GAAI3E,UAAY,sBAAoBoE,EAAa,IAAGA,EAAUpE,UAAc,KACzF,4BAAQkG,QA1CZ,UAAwB,cAAEC,IACxB,IAAIF,EAAM,EAENzB,EAAMa,QACRE,OAAOC,oBAAoB,QAASX,IAGpCU,OAAOa,iBAAiB,QAASvB,GACjCoB,EAAME,EAAcJ,wBAAwBM,QAE9C5B,EAAS,CACPE,GAAIH,EAAMG,GACVU,SAAS,EACTC,QAASd,EAAMa,QACfY,MACAD,OAAO,KA4BLlG,MAAOuE,EAAOvE,MACdE,UAAY,GAAEqE,EAAOrE,YAAYwE,EAAMa,QAAU,UAAY,MAC5DhB,EAAOiC,SAEV,yBAAKC,IAAKb,EAAM1F,UAAY,WAAUsE,EAAQ,IAAGA,EAAKtE,UAAc,KAAKwE,EAAMc,OAAS,UAAY,KAAKd,EAAMa,QAAU,WAAa,KAAKb,EAAMwB,MAAQ,OAAS,MAAOzB,M,yEC9EhKiC,ICIA,UAAsB,aAAEC,EAAF,WAAgBC,EAAhB,OAA4BC,EAA5B,SAAoCpC,EAApC,QAA8CqC,IACjF,MAAOpC,EAAOC,GAAYC,mBAAS+B,IAC5BI,EAAUC,GAAepC,oBAAS,GACnCqC,EAAON,EAAaM,MAAQ,WAoBlC,OAlBApB,oBAAU,KACR,IAAKnB,EAAMwC,UAAYxC,IAAUiC,EAAc,CAC7C,GAAIjC,EAAMyC,QAAUR,EAAaQ,MAE/B,YADAxC,EAASgC,GAGXhC,EAAS,IAAKD,EAAOwC,UAAU,IAE/BE,WAAW,KACTzC,EAASgC,IACR,OAEJ,CAACjC,EAAOiC,IAOT,yBAAKzG,UAAWsB,YAAW,eAAgByF,EAAMJ,EAAU,UAASA,EAAW,GAAIE,EAAW,WAAa,GAAIrC,EAAMwC,SAAW,QAAU,KACxI,kBAACpH,EAAA,EAAD,CAAMC,KAAe,aAATkH,EAAsB,eAAiB,eAAgB/G,UAAU,oBAAoBD,KAAK,SACrG2G,EACC,yBAAK1G,UAAU,6CACb,yBAAKA,UAAU,mCACb,8BAAOyG,EAAaQ,OACpB,4BAAQjH,UAAU,wDAChBkG,QAZZ,WACEY,GAAaD,IAWsB/G,MAAM,UAC/BG,MAAO,CAAEkH,UAAY,WAAUN,EAAW,SAAW,SACrD,kBAACjH,EAAA,EAAD,CAAMC,KAAK,gBAGdgH,GAAYtC,GAEb,0BAAMvE,UAAU,qBAAqBwE,EAAMyC,OAC/C,4BAAQF,KAAK,SAAS/G,UAAU,yDAC9BkG,QAASU,EAAS9G,MAAM,WACxB,kBAACF,EAAA,EAAD,CAAMC,KAAK,c,8BC9CnB,0EAAMS,EAAW8G,KAAKC,MAAMC,aAAaC,QAAQ,cAAgB,CAC/DC,gBAAgB,EAChBC,WAAY,OACZC,cAAc,EACdC,oBAAoB,GAGtB,SAASC,IACP,OAAOtH,EAGT,SAASuH,EAAWC,EAAKb,GACvB3G,EAASwH,GAAOb,EAChBK,aAAaS,QAAQ,WAAYX,KAAKY,UAAU1H,M,6QCblD,MAAM2H,EACFC,YAAYC,EAAS,eAAgBC,EAAY,UAC7CC,KAAKD,UAAYA,EACjBC,KAAKC,KAAO,IAAIC,QAAQ,CAACC,EAASC,KAC9B,MAAMC,EAAUC,UAAUC,KAAKT,EAAQ,GACvCO,EAAQG,QAAU,IAAMJ,EAAOC,EAAQI,OACvCJ,EAAQK,UAAY,IAAMP,EAAQE,EAAQM,QAE1CN,EAAQO,gBAAkB,KACtBP,EAAQM,OAAOE,kBAAkBd,MAI7Ce,cAAcpC,EAAMqC,GAChB,OAAOf,KAAKC,KAAKe,KAAKC,GAAM,IAAIf,QAAQ,CAACC,EAASC,KAC9C,MAAMc,EAAcD,EAAGC,YAAYlB,KAAKD,UAAWrB,GACnDwC,EAAYC,WAAa,IAAMhB,IAC/Be,EAAYE,QAAUF,EAAYV,QAAU,IAAMJ,EAAOc,EAAYT,OACrEM,EAASG,EAAYG,YAAYrB,KAAKD,gBAIlD,IAAIuB,EACJ,SAASC,IAGL,OAFKD,IACDA,EAAQ,IAAI1B,GACT0B,ECxBX,MAAMA,EAAQ,IAAI1B,EAAM,aAAc,SAEtC,SAAS4B,IACP,OD4CF,SAAcF,EAAQC,KAClB,MAAME,EAAO,GACb,OAAOH,EAAMR,cAAc,WAAYQ,KAGlCA,EAAMI,eAAiBJ,EAAMK,YAAYC,KAAKN,GAAOZ,UAAY,WACzDV,KAAKW,SAEVc,EAAKI,KAAK7B,KAAKW,OAAOlB,KACtBO,KAAKW,OAAOmB,eAEjBd,KAAK,IAAMS,GCvDTA,CAAKH,GAAON,KAAKS,GAAQvB,QAAQ6B,IAAIN,EAAKO,IAAIC,KAClDjB,KAAKkB,GACLC,MAAMC,IACLC,QAAQC,IAAIF,GACL,KAIb,SAASH,EAAa3F,GACpB,ODcF,SAAamD,EAAK6B,EAAQC,KACtB,IAAIgB,EACJ,OAAOjB,EAAMR,cAAc,WAAYQ,IACnCiB,EAAMjB,EAAMkB,IAAI/C,KACjBuB,KAAK,IAAMuB,EAAI5B,QClBb6B,CAAIlG,EAAIgF,GAGjB,SAASmB,EAASC,IDiBlB,SAAajD,EAAKb,EAAO0C,EAAQC,KACtBD,EAAMR,cAAc,YAAaQ,IACpCA,EAAMqB,IAAI/D,EAAOa,KClBvBmD,CAAIF,EAAQpG,GAAIoG,EAASpB,GAG3B,SAASuB,EAAcvG,GACrB,ODiBF,SAAamD,EAAK6B,EAAQC,KACtB,OAAOD,EAAMR,cAAc,YAAaQ,IACpCA,EAAMwB,OAAOrD,KCnBZsD,CAAIzG,EAAIgF,GAAON,KAAK,KAAM,GAGnC,SAASkB,EAAUc,GACjB,MAAOC,EAASC,GAAQF,EAAMG,OAAO,CAACC,EAAK/I,KACrB,YAAhBA,EAAKgJ,OACPD,EAAI,GAAGvB,KAAKxH,GAGZ+I,EAAI,GAAGvB,KAAKxH,GAEP+I,GACN,CAAC,GAAI,KAER,OAGF,SAA0BJ,GACxB,OAAOA,EAAMM,KAAK,CAACC,EAAGC,IACbA,EAAEC,WAAaF,EAAEE,YALnBC,CAAiBT,GAASU,OASnC,SAAuBX,GACrB,OAAOA,EAAMM,KAAK,CAACC,EAAGC,IACbD,EAAEK,UAAYJ,EAAEI,WAXeC,CAAcX,M,+DCnCzCY,ICGA,UAAkB,KAAEzJ,EAAF,SAAQ0J,EAAR,SAAkB7H,IACjD,OACE,wBAAIvE,UAAU,aACXoM,EACC,kBAAC,IAAD,CAAMC,GAAK,WAAU3J,EAAKiC,GAAM3E,UAAU,iBAAiBF,MAAQ,QAAO4C,EAAK7C,MAC7E,yBAAKiE,IAAKpB,EAAK4J,WAAYtM,UAAU,kBAAkBgE,IAAI,MAE3D,yBAAKF,IAAKpB,EAAK4J,WAAYtM,UAAU,iCAAiCgE,IAAI,KAC9E,yBAAKhE,UAAU,kBACb,yBAAKA,UAAU,mBAAmB0C,EAAK5C,OAAS4C,EAAK7C,MACpD6C,EAAKU,QAAU,yBAAKpD,UAAU,oBAAoB0C,EAAKU,QACxD,yBAAKpD,UAAU,4BACZ0C,EAAK5C,OAAS,yBAAKE,UAAU,oDAAoD0C,EAAK7C,MACvF,yBAAKG,UAAU,iCAAiC0C,EAAK6J,aAEvD,yBAAKvM,UAAU,+BACbF,MAAQ,GAAE4C,EAAK8J,iBAAiB9J,EAAK+J,iBAAoC,IAAnB/J,EAAK+J,UAAkB,GAAK,YAClF,yBAAKzM,UAAU,sBACb,yBAAKA,UAAU,yBAAyBC,MAAO,CAAEyM,MAAUhK,EAAK8J,WAAa,GAAK9J,EAAK+J,UAAY,IAA3C,SAG5D,yBAAKzM,UAAU,oBAAoBuE,O,oMCpB3C,IAAIoI,EAAoC,qBAAXC,QAA0BA,OAAOD,iBAAmBC,OAAOD,gBAAgBE,KAAKD,SAA+B,qBAAbE,UAAgE,oBAA7BA,SAASH,iBAAkCG,SAASH,gBAAgBE,KAAKC,UACvOC,EAAQ,IAAIjK,WAAW,IACZ,SAASkK,IACtB,IAAKL,EACH,MAAM,IAAIM,MAAM,4GAGlB,OAAON,EAAgBI,GCZV,4HCQf,ICFeG,MAJf,SAAkBC,GAChB,MAAuB,kBAATA,GAAqBC,EAAMC,KAAKF,IDG5CG,EAAY,GAEPC,EAAI,EAAGA,EAAI,MAAOA,EACzBD,EAAUpD,MAAMqD,EAAI,KAAOC,SAAS,IAAIC,OAAO,IAoBlCzF,MAjBf,SAAmByD,GACjB,IAAIiC,EAASC,UAAUlK,OAAS,QAAsBmK,IAAjBD,UAAU,GAAmBA,UAAU,GAAK,EAG7ER,GAAQG,EAAU7B,EAAIiC,EAAS,IAAMJ,EAAU7B,EAAIiC,EAAS,IAAMJ,EAAU7B,EAAIiC,EAAS,IAAMJ,EAAU7B,EAAIiC,EAAS,IAAM,IAAMJ,EAAU7B,EAAIiC,EAAS,IAAMJ,EAAU7B,EAAIiC,EAAS,IAAM,IAAMJ,EAAU7B,EAAIiC,EAAS,IAAMJ,EAAU7B,EAAIiC,EAAS,IAAM,IAAMJ,EAAU7B,EAAIiC,EAAS,IAAMJ,EAAU7B,EAAIiC,EAAS,IAAM,IAAMJ,EAAU7B,EAAIiC,EAAS,KAAOJ,EAAU7B,EAAIiC,EAAS,KAAOJ,EAAU7B,EAAIiC,EAAS,KAAOJ,EAAU7B,EAAIiC,EAAS,KAAOJ,EAAU7B,EAAIiC,EAAS,KAAOJ,EAAU7B,EAAIiC,EAAS,MAAMG,cAMzf,IAAKX,EAASC,GACZ,MAAMW,UAAU,+BAGlB,OAAOX,GEHMY,IApBf,SAAYC,EAASC,EAAKP,GAExB,IAAIQ,GADJF,EAAUA,GAAW,IACFG,SAAWH,EAAQhB,KAAOA,KAK7C,GAHAkB,EAAK,GAAe,GAAVA,EAAK,GAAY,GAC3BA,EAAK,GAAe,GAAVA,EAAK,GAAY,IAEvBD,EAAK,CACPP,EAASA,GAAU,EAEnB,IAAK,IAAIH,EAAI,EAAGA,EAAI,KAAMA,EACxBU,EAAIP,EAASH,GAAKW,EAAKX,GAGzB,OAAOU,EAGT,OAAOjG,EAAUkG,K,8JCnBJE,MCOA,UAAqB,KAAE1L,EAAF,aAAQ+D,EAAR,oBAAsB4H,EAAtB,iBAA2CC,EAA3C,YAA6DC,IAC/F,OACE,yBAAKvO,UAAU,iCACb,kBAAC6D,EAAA,EAAD,MACA,yBAAK7D,UAAU,uBACW,cAAX,OAAZyG,QAAY,IAAZA,OAAA,EAAAA,EAAcM,OACb,kBAACP,EAAA,EAAD,CAAcC,aAAcA,EAAcE,OAAO,SAASC,QAASyH,IAErE,kBAAClC,EAAA,EAAD,CAAUzJ,KAAMA,GACd,kBAAC,IAAD,CAAM2J,GAAG,IAAIrM,UAAU,eAAeF,MAAM,iBAC1C,kBAACF,EAAA,EAAD,CAAMC,KAAK,YAAYE,KAAK,UAE9B,2BAAOC,UAAU,sCACf,2BAAO+G,KAAK,OAAOyH,SAAUF,EAAkBtO,UAAU,UAAUyO,OAAO,oBAC1E,+CAGoB,aAAX,OAAZhI,QAAY,IAAZA,OAAA,EAAAA,EAAcM,OACb,yBAAK/G,UAAU,+BACb,yBAAKA,UAAU,oCACb,kBAACJ,EAAA,EAAD,CAAMC,KAAK,OAAOG,UAAU,mCAAmCD,KAAK,SACpE,uBAAGC,UAAU,uCAAuCyG,EAAaQ,QAEnE,yBAAKjH,UAAU,sCACb,4BAAQA,UAAU,+CAA+CkG,QAASmI,GAA1E,MACA,4BAAQrO,UAAU,sCAAsCkG,QAASqI,GAAjE,Y,MChCCG,MCIA,UAAkB,KAAEhM,IACjC,OACE,kBAACyB,EAAA,EAAD,CACEE,OAAQ,CACNiC,QAAS,kBAAC1G,EAAA,EAAD,CAAMC,KAAK,SACpBC,MAAO,cACPE,UAAW,6BAEbsE,KAAM,CAAEtE,UAAW,cACnB,yBAAK8D,IAAKpB,EAAK4J,WAAYtM,UAAU,kBAAkBgE,IAAI,KAC3D,6BACE,yBAAKhE,UAAU,0BACb,4CACA,8BAAO0C,EAAK7C,OAEd,yBAAKG,UAAU,0BACb,4CACA,8BAAO0C,EAAK6J,aAEd,yBAAKvM,UAAU,0BACb,yCACA,8BAAO0C,EAAK5C,OAAS,MAEvB,yBAAKE,UAAU,0BACb,yCACA,8BAAO0C,EAAKU,QAAU,MAExB,yBAAKpD,UAAU,0BACb,6CACA,8BAAO0C,EAAK+J,e,MCjCPkC,MCKA,WACb,OACE,yBAAK3O,UAAU,kBACb,kBAAC6D,EAAA,EAAD,MACA,uBAAG7D,UAAU,0BAAb,mBACA,kBAAC,IAAD,CAAMqM,GAAG,IAAIrM,UAAU,iCACrB,kBAACJ,EAAA,EAAD,CAAMC,KAAK,YAAYE,KAAK,SAC5B,kD,MCZO6O,UCaA,WACb,MACMC,EAAUC,eACV,GAAEnK,GAAOoK,eACRvK,EAAOC,GAAYC,mBAAS,OAC5B8H,EAAYwC,GAAiBtK,mBAAS,IACtCxC,EAAO+M,GAAYvK,mBAAS,CAAE7E,KAAM,IAAKoH,MAL1B,UAMfiI,EAAiBC,GAAsBzK,mBAAS,OAChDpE,EAAU8O,GAAe1K,mBAAS,IACnC2K,EAAS5J,iBAAO,MAChB6J,EAAa7J,iBAAO,MACpBkC,EAAqBlC,kBAAO,GAC5B8J,EAAsB9J,iBAAO,GAC7B+J,EAAgB/J,kBAAO,GACvBgK,EAAehK,iBAAO,IACtBiK,EAAWjK,iBAAO,MAClBkK,EAAgBlK,iBAAO,GACvBmK,EAAqBnK,kBAAO,GAC5BoK,EAAgBpK,kBAAO,GACvBqK,EAAkBrK,iBAAO,GACzBsK,EAActK,kBAAO,GACrBuK,EAAwBlL,uBA0M9B,WACE,GAAI8K,EAAmBxK,QACrB,OAEFwK,EAAmBxK,SAAU,EAE7B6K,sBAAsB,KACpB,MAAM,UAAEC,EAAF,WAAaC,GAAe9O,SAASwE,gBACrCuK,EAAgB5L,EAAM9B,KAAK8J,WAC3B6D,EAAa7L,EAAM9B,KAAKwN,UAAYA,EAC1CJ,EAAgB1K,QAAU8K,EAAY1L,EAAM9B,KAAKwN,UAAY,GAAK,EAClE1L,EAAM9B,KAAKwN,UAAYA,EAAY,EAAI,EAAIA,EAC3C1L,EAAM9B,KAAKyN,WAAaA,EACxB3L,EAAM9B,KAAK8J,WAwSf,SAA8B8D,EAAOrK,GACnC,IAAK,IAAIsH,EAAI,EAAGA,EAAI+C,EAAM7M,OAAS,EAAG8J,GAAK,EAAG,CAC5C,MAAMgD,EAAOD,EAAM/C,GACbiD,EAAQF,EAAM/C,EAAI,GAClBG,EAAS6C,EAAKtK,IAAOsK,EAAKtP,OAAS,EACnCwP,EAAUD,EAAMvK,IAAOuK,EAAMvP,OAAS,EAE5C,GAAIgF,GAAOyH,GAAUzH,GAAOwK,EAC1B,OAAOlD,EAAI,EAGf,OAAO,EAnTmBmD,CAAqBlM,EAAM8L,MAAO9L,EAAM9B,KAAKwN,WAEhEvI,EAAmBvC,UACU,IAA5B0K,EAAgB1K,QAqGnBkK,EAAWlK,QAAQuL,UAAUC,SAAS,YACzCrB,EAAoBnK,QAAU,EAC9BkK,EAAWlK,QAAQuL,UAAUE,IAAI,UAEjC3J,WAAW,KACToI,EAAWlK,QAAQuL,UAAUE,IAAI,WAChC,MAxGSrM,EAAM9B,KAAKwN,UAGZX,EAAoBnK,QAAU,IACrC0L,IAGAvB,EAAoBnK,SAAWiL,EAN/BS,KASJnJ,EAAmBvC,SAAU,EAE7B2L,aAAapB,EAAcvK,SAC3BuK,EAAcvK,QAAU8B,WAAW,KACjC4D,YAAStG,EAAM9B,OACd,KAEC8B,EAAM9B,KAAK8J,aAAe4D,IAC5BpB,EAAcxK,EAAM9B,KAAK8J,YACzB/H,EAAS,IAAKD,KAEhBoL,EAAmBxK,SAAU,MAlPuB,CAAClD,IACnD8O,EAA2BlM,uBAqPjC,SAAwBmM,GAClBA,EAAMC,QAAU,IAClBD,EAAME,QAAUF,EAAM9K,cAAciL,aACpC9B,EAAWlK,QAAQuL,UAAUC,SAAS,YAEtCtB,EAAWlK,QAAQuL,UAAUU,OAAO,UAEpCnK,WAAW,KACToI,EAAWlK,QAAQuL,UAAUU,OAAO,WACnC,QA9PsD,CAACnP,IACxDoP,EAAuBxM,uBAiQ7B,SAAqBmM,GACflB,EAAY3K,UACd6L,EAAMM,iBAEFN,EAAMO,WAAa,EACrBC,IAGAC,OAzQgD,CAACxP,IACjDyP,EAAuB7M,uBA4S7B,SAAqBmM,GACnBlB,EAAY3K,QAAU6L,EAAMW,UA7SwB,CAAC1P,IACjD2P,EAAyB/M,uBA4Q/B,SAAuBmM,GACrB,GAA8B,UAA1BA,EAAMlM,OAAO+M,SACf,OAIF,GAFA/B,EAAY3K,QAAU6L,EAAMW,QAExBX,EAAMW,QASR,MARkB,MAAdX,EAAMnJ,MACR2J,IACAR,EAAMM,uBAEU,MAAdN,EAAMnJ,MACR4J,IACAT,EAAMM,mBAIV,MAAM,YAAEQ,EAAF,YAAeC,GAAgB3Q,SAASwE,gBAE1CkM,GAAeC,IACC,cAAdf,EAAMnJ,KACRmK,IACAhB,EAAMM,kBAEe,eAAdN,EAAMnJ,MACboK,IACAjB,EAAMM,qBAtS8C,CAACrP,EAAOsK,IA+SlE,SAASsE,IACHxB,EAAWlK,QAAQuL,UAAUC,SAAS,YACxCrB,EAAoBnK,QAAU,EAC9BkK,EAAWlK,QAAQuL,UAAUU,OAAO,UAEpCnK,WAAW,KACToI,EAAWlK,QAAQuL,UAAUU,OAAO,WACnC,MAmCP5P,eAAe0Q,EAAkBxQ,GAC/B,MAAMyQ,EAAa,GAEnB,IAAK,IAAI7E,EAAI,EAAGA,EAAI5L,EAAI0Q,SAAU9E,GAAK,EAAG,CACxC,MAAM3L,QAAaD,EAAIE,QAAQ0L,EAAI,IAC7B,MAAEvM,EAAF,OAASC,GAAWW,EAAKK,YAAY,CAAEC,MAAO,IAEpDkQ,EAAWlI,KAAK,CAAElJ,QAAOC,WAE3B,OAAOmR,EAGT3Q,eAAe6Q,EAAgB/E,EAAGrL,EAAOqQ,EAAW5Q,GAClD,MAAM6Q,EAAMnR,SAASU,cAAc,OAE7BC,SADaL,EAAIE,QAAQ0L,IACTtL,YAAY,CAAEC,MAAOA,EAAM+E,QAEjDuL,EAAIvS,MAAMe,MAAW2C,KAAK8O,MAAMzQ,EAAShB,OAAtB,KACnBwR,EAAIvS,MAAMgB,OAAY0C,KAAK8O,MAAMzQ,EAASf,QAAtB,KAEpBuR,EAAIE,aAAa,mBAAoBnF,GACrCiF,EAAI7B,UAAUE,IAAI,eAClB0B,EAAUI,YAAYH,GAGxB/Q,eAAemR,EAAiBjR,EAAKO,GACnC,MAAM2Q,EAAW,IAAIC,iBACfC,EAAW,GAEjB,IAAK,IAAIxF,EAAI,EAAGA,EAAI5L,EAAI0Q,SAAU9E,GAAK,EACrCwF,EAAS7I,KAAKoI,EAAgB/E,EAAI,EAAGrL,EAAO2Q,EAAUlR,UAElD4G,QAAQ6B,IAAI2I,GAClB1D,EAAOjK,QAAQuN,YAAYE,GAG7BpR,eAAeuR,EAAStQ,EAAMuQ,EAAU,KAAMC,EAAc,MAC1D,MAAMC,EAAYF,GAAWzO,EAAM9B,KACnCyQ,EAAUjR,MAAQiR,EAAUjR,OAAS,CAAErC,KAAM,IAAKoH,MAvZ9B,QAwZpBkM,EAAU3G,WAAa2G,EAAU3G,YAAc,EAC/C,MAAM7K,EAAMuR,SAAqBzQ,YAAeC,EAAMC,KAC/C,SAAEyQ,EAAF,UAAYC,GAAaC,SAAwB/K,QAAQ6B,IAAI,CAClEmJ,EAAsB5R,GACtBwQ,EAAkBxQ,GAClBiR,EAAiBjR,EAAKwR,EAAUjR,gBAG3BsC,EAAMgP,mBAEb/O,EAAS,IACJD,EACHiP,SAAU9R,EACV2R,iBACA5Q,KAAMyQ,EACNC,WACAC,cAGF9N,OAAOmO,SAASP,EAAUhD,WAAYgD,EAAUjD,WAChDjB,EAASkE,EAAUjR,OACnB8M,EAAcmE,EAAU3G,YAEC,SAArB2G,EAAUzH,SACgB,IAAxByH,EAAU1G,UACZ0G,EAAUzH,OAAS,OAGnByH,EAAUzH,OAAS,WAGvByH,EAAUrH,WAAa6H,KAAKC,MAC5B9I,YAASqI,GAkDX1R,eAAe8R,EAAsB5R,GACnC,IAAIyR,EAAW,EACXC,EAAY,EAEhB,IAAK,IAAI9F,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAAG,CAC7B,MAAM3L,QAAaD,EAAIE,QAAQ0L,IACzB,MAAEvM,EAAF,OAASC,GAAWW,EAAKK,YAAY,CAAEC,MAAO,IAEhDlB,EAAQoS,IACVA,EAAWpS,GAGTC,EAASoS,IACXA,EAAYpS,GAGhB,MAAO,CACLmS,SAAUzP,KAAK8O,MAAMW,GACrBC,UAAW1P,KAAK8O,MAAMY,IAI1B5R,eAAeoS,EAAa5C,GAC1B,IAAI6C,EAjgBgB,OAmgBpB,GAA2B,cAAvB7C,EAAMlM,OAAOkC,MAAuB,CAEtC6M,GADiBzS,SAASwE,gBAAgBmM,YAAc,IAClCxN,EAAM4O,cAEzB,GAA2B,aAAvBnC,EAAMlM,OAAOkC,MAAsB,CAC1C,MAAM,mBAAEU,GAAuBrH,EAE/BwT,GADkBzS,SAASwE,gBAAgBC,cAAgB6B,EAAqB,GAAK,KAC9DnD,EAAM6O,eAG7BS,EA7gBkB,OA6gBS7C,EAAMlM,OAAOkC,MAE1C4I,EAAczK,SAAU,EACxB6J,EAAS,CAAEpP,KAAMoR,EAAMlM,OAAOkC,MAAOA,MAAO6M,IAiB9C,SAASpC,IACP7B,EAAczK,SAAU,EACxB6J,EAAS,CAAEpP,KAAM,SAAUoH,MAAOtD,KAAKoQ,IAAI7R,EAAM+E,MAAQ,IAAK,WAGhE,SAASwK,IACP5B,EAAczK,SAAU,EACxB6J,EAAS,CAAEpP,KAAM,SAAUoH,MAAOtD,KAAKqQ,IAAkB,IAAd9R,EAAM+E,MAAa,UAGhE,SAASgL,IACPtK,EAAmBvC,SAAU,EAC7B6O,GAAazH,EAAa,GAG5B,SAAS0F,IACPvK,EAAmBvC,SAAU,EAC7B6O,GAAazH,EAAa,GAG5B,SAAS0H,GAAmBjD,GACR,UAAdA,EAAMnJ,KACRmJ,EAAMlM,OAAOoP,OAIjB,SAASC,GAAgBnD,GACvB,IAAIoD,EAASC,SAASrD,EAAMlM,OAAOkC,MAAO,IAEtCsN,OAAOC,MAAMH,GACfA,EAAS7P,EAAM9B,KAAK8J,WAEb6H,EAAS,EAChBA,EAAS,EAEFA,EAAS7P,EAAM9B,KAAK+J,YAC3B4H,EAAS7P,EAAM9B,KAAK+J,WAEtBwE,EAAMlM,OAAO9E,MAAMe,MAAWqT,EAAO7G,WAAW/J,OAApB,KAExB4Q,IAAW7H,IACb7E,EAAmBvC,SAAU,EAC7B6O,GAAaI,IAIjB,SAASI,GAAkBxD,GACzBjC,EAAciC,EAAMlM,OAAOkC,OAG7B,SAASyN,GAAiBzD,GACpBA,EAAMlM,SAAWkM,EAAM9K,cAAcwO,mBACvC1D,EAAM9K,cAAcwO,kBAAkBC,QAI1C,SAASC,GAAiB5D,GACxB,MAAMjQ,EAAQwD,EAAM9B,KAAK+J,UAAY,IAAO,EAAIjI,EAAM9B,KAAK+J,UAAUe,WAAW/J,OAChFwN,EAAMlM,OAAO9E,MAAMe,MAAWA,EAAF,KAC5BiQ,EAAMlM,OAAO+P,SAGf,SAASC,GAAsBV,EAAQjL,GACrC,IAAK,MAAM4L,KAAW3F,EAAOjK,QAAQb,SACnC,GAAI+P,SAASU,EAAQC,aAAa,oBAAqB,MAAQZ,EAC7D,OAAOjL,EAAS4L,GAStB,SAASf,GAAaI,GACpBU,GAAsBV,EAAQW,IAC5B,MAAMtH,EAASpN,EAASqH,mBAAqB,GAAK,EAClDpC,OAAOmO,SAASlP,EAAM9B,KAAKyN,WAAY6E,EAAQE,UAAYxH,KAQ/D,SAASyH,IAAoB,OAAEpQ,IAC7BqK,EAAY,IAAK9O,EAAU,CAACyE,EAAOlF,MAAOkF,EAAOqQ,UACjDvN,YAAW9C,EAAOlF,KAAMkF,EAAOqQ,SAkFjC,OAhrBAzP,oBAAU,KAkLVlE,iBACE,GAAIoN,EAAQwG,SAAS7Q,MACnB,OAEF,MAAM9B,QAAa4H,YAAa3F,GAE5BjC,GACF+B,EAAS,CAAE/B,OAAM8Q,oBAAoB,IACrCpE,EAAYxH,eACZxG,YAAiBsB,EAAK7C,MACtBwB,SAASiD,KAAKrE,MAAMqV,mBAAqB,SAGzC7Q,EAAS,CAAEqE,OAAO,IAClB1H,YAAiB,UA/LnBmU,GAEO,KACLlU,SAASiD,KAAKrE,MAAMqV,mBAAqB,KAE1C,CAAC3Q,IAEJgB,oBAAU,KACR,IAAKnB,IAAUA,EAAMiP,SACnB,OAEF,MAAM9R,EAAM0N,EAAOjK,QAOnB,OALAzD,EAAIyE,iBAAiB,YAAa4K,GAClCzL,OAAOa,iBAAiB,SAAU4J,GAClCzK,OAAOa,iBAAiB,QAASkL,EAAsB,CAAEkE,SAAS,IAClEjQ,OAAOa,iBAAiB,QAASuL,GAE1B,KACLhQ,EAAI6D,oBAAoB,YAAawL,GACrCzL,OAAOC,oBAAoB,SAAUwK,GACrCzK,OAAOC,oBAAoB,QAAS8L,EAAsB,CAAEkE,SAAS,IACrEjQ,OAAOC,oBAAoB,QAASmM,KAErC,CAAC3B,EAAuBgB,EAA0BM,EAAsBK,IAE3EhM,oBAAU,KACRJ,OAAOa,iBAAiB,UAAWyL,GAE5B,KACLtM,OAAOC,oBAAoB,UAAWqM,KAEvC,CAACA,IAEJlM,oBAAU,KACHnB,GAAUA,EAAMiP,YA8BrB,SAAiCK,GAC/B,MAAM3D,EAAa9O,SAASwE,gBAAgBsK,YACtC,IAAElK,GA0gBH8O,GA1gB6BvI,EA0gBCwI,GAAWA,EAAQjP,0BAviBxD,SAAqB0P,GACnB,IAAK,MAAOC,EAAOV,KAAYW,OAAOC,QAAQvG,EAAOjK,QAAQb,UAAW,CACtE,MAAMsR,EAAgBrR,EAAM8O,eAAeoC,GACrCI,EAAInS,KAAK8O,MAAMoD,EAAc7U,MAAQyU,GACrCM,EAAIpS,KAAK8O,MAAMoD,EAAc5U,OAASwU,GAK5C,GAHAT,EAAQ/U,MAAMe,MAAW8U,EAAF,KACvBd,EAAQ/U,MAAMgB,OAAY8U,EAAF,KAEpBf,EAAQgB,aAAa,eAAgB,CACvC,MAAMlU,EAASkT,EAAQL,mBACjB,MAAE3T,GAAUc,EAEdgU,IAAM9U,GACRc,EAAO7B,MAAMe,MAAQ,GACrBc,EAAO7B,MAAMgB,OAAS,GACtB+T,EAAQiB,gBAAgB,0BAGxBnU,EAAO7B,MAAMe,MAAW8U,EAAF,KACtBhU,EAAO7B,MAAMgB,OAAY8U,EAAF,KACvBf,EAAQtC,aAAa,wBAAwB,MAUnDwD,CAAYpC,EAAS7M,OAErBzC,EAAM9B,KAAKR,MAAQ4R,EACnBtP,EAAM8L,MA2PD6F,MAAMC,KAAK/G,EAAOjK,QAAQb,UAAU8F,IAAI2K,IACtC,CACL/O,IAAK+O,EAAQE,UACbxI,KAAMsI,EAAQqB,WACdrV,MAAOgU,EAAQhD,YACf/Q,OAAQ+T,EAAQlP,gBA/PlBtB,EAAM9B,KAAKwN,UAAY1L,EAAM8L,MAAM9D,EAAa,GAAGvG,IAAMA,EAAM6N,EAAS7M,MAAQzC,EAAM9B,KAAKR,MAAM+E,MACjGzC,EAAM9B,KAAKyN,WAAaA,EAAa2D,EAAS7M,MAAQzC,EAAM9B,KAAKR,MAAM+E,MACvEzC,EAAM8R,gBAkQV,SAA6BhG,GAC3B,MAAMiG,EAAQ5S,KAAK6S,KAAKnV,SAASwE,gBAAgBC,eAAiBwK,EAAM,GAAGrP,OAASqP,EAAM,GAAGrP,QAAU,IAEvG,GAAIsV,EAAQ,EACV,OAAO,EAET,OAAOA,EAxQmBE,CAAoBjS,EAAM8L,OAElD/K,OAAOmO,SAASlP,EAAM9B,KAAKyN,WAAY3L,EAAM9B,KAAKwN,WAClDzL,EAAS,IAAKD,IACdsG,YAAStG,EAAM9B,MAoFjBgU,CAAwBxU,GAEpBwN,EAAStK,SACXsK,EAAStK,QAAQuR,aAEnBjH,EAAStK,QAAU,IAAIwR,sBAtFvB,SAAkBhB,GAChBA,EAAQiB,QAAQ,EAAGC,iBAAgB/R,cAC5B+R,GAAmB/R,EAAOiR,aAAa,iBAAmBjR,EAAOiR,aAAa,0BAI/ExG,EAAcpK,QAChBqK,EAAarK,QAAQ8E,KAAKnF,IAG1ByK,EAAcpK,SAAU,EACxBL,EAAO2N,aAAa,cAAe,QAMzCjR,eAAesV,EAAkB3S,GAC/B,MAAMiQ,EAASC,SAASlQ,EAAU6Q,aAAa,oBAAqB,IAC9DY,EAAgBrR,EAAM8O,eAAee,EAAS,GAC9CyB,EAAInS,KAAK8O,MAAMoD,EAAc7U,MAAQkB,EAAM+E,OAC3C8O,EAAIpS,KAAK8O,MAAMoD,EAAc5U,OAASiB,EAAM+E,OAC5CnF,EAAST,SAASU,cAAc,UACtC,IAAIiV,EAAe,KACfC,EAAY,KAEhBnV,EAAO6O,UAAUE,IAAI,sBAEjBzM,EAAU4R,aAAa,yBACzBiB,EAAY7S,EAAUuQ,kBACtBqC,EAAe5S,EAAU8S,iBACzBF,EAAaG,UAAY,GAEzB/S,EAAU6R,gBAAgB,0BAG1Be,EAAe3V,SAASU,cAAc,OACtCiV,EAAarG,UAAUE,IAAI,oBAE3BzM,EAAUuO,YAAY7Q,GACtBsC,EAAUuO,YAAYqE,IAExB,MAAMpV,QAAa4C,EAAMiP,SAAS5R,QAAQwS,GACpCrS,EAAWJ,EAAKK,YAAY,CAAEC,MAAOA,EAAM+E,QAEjDnF,EAAOd,MAAQ8U,EAAI,IAAM,EAAIA,EAAIA,EAAI,EACrChU,EAAOb,OAAS8U,EAAI,EACpBiB,EAAa/W,MAAMe,MAAW8U,EAAF,KAC5BkB,EAAa/W,MAAMgB,OAAY8U,EAAF,WAEvBnU,EAAKQ,OAAO,CAChBC,cAAeP,EAAOQ,WAAW,MACjC8U,aAAa,EACbpV,aACCO,QAEH0N,sBAAsBxO,UACpBkB,kBAAsB,CACpB0U,kBAAmBzV,EAAK0V,iBACxBlT,UAAW4S,EACXhV,WACAuV,SAAU,OAIVN,GACF7S,EAAUoT,aAAa1V,EAAQmV,GAGjC,GAAIxH,EAAarK,QAAQ3B,OACvB,KAAOgM,EAAarK,QAAQ3B,QAAQ,CAClC,MAAMuR,EAAsC,IAA5BlF,EAAgB1K,QAAgBqK,EAAarK,QAAQqS,MAAQhI,EAAarK,QAAQsS,QAClG1C,EAAQtC,aAAa,cAAe,QACpCqE,EAAkB/B,QAIpBxF,EAAcpK,SAAU,EAjEtB2R,CAAkBhS,SA0E8B,CACpD4S,WAAenT,EAAM6O,UAAY7O,EAAM9B,KAAKR,MAAM+E,MAArC,WAEfkP,MAAMC,KAAK/G,EAAOjK,QAAQb,UAAUsS,QAAQ7B,IAC1CtF,EAAStK,QAAQwS,QAAQ5C,KAE3BnF,EAAczK,SAAU,IACvB,CAAClD,KAggBJ,OAAIsC,QAAJ,IAAIA,OAAJ,EAAIA,EAAOsE,OAEP,kBAAC,EAAD,MAKF,qCACQ,OAALtE,QAAK,IAALA,OAAA,EAAAA,EAAOgP,qBAAsB,kBAAC,EAAD,CAAa9Q,KAAM8B,EAAM9B,KAAM+D,aAAcyI,EACzEb,oBAjGN,WACEc,EAAmB,OAiGfb,iBAjQN7M,eAAgCwP,GAC9B,MAAOvO,GAAQuO,EAAMlM,OAAOsG,MAEvB3I,EAAK7C,KAAKgY,SAAS,QAOfnV,EAAK7C,OAAS2E,EAAM9B,KAAK7C,KAChCsP,EAAmB,CACjBzM,OACAqE,KAAM,UACNE,MAAO,+EAIT+L,EAAStQ,GAdTyM,EAAmB,CACjBzM,OACAqE,KAAM,WACNE,MAAO,2BAaXgK,EAAMlM,OAAOkC,MAAQ,IA8OjBsH,YA1RN9M,iBACE,MAAM,KAAEiB,GAASwM,EAEjB,IAAI+D,SADgBpJ,eACAiO,KAAK,EAAGjY,UAAWA,IAAS6C,EAAK7C,MACjD8B,EAAM,KAEV,IAAKsR,EAAS,CACZtR,QAAYc,YAAeC,EAAMC,GACjC,MAAOK,EAAUsJ,SAAoB/D,QAAQ6B,IAAI,CAACzI,EAAIoW,cAAerW,YAAcC,KACnFsR,EAAU,IACLlQ,YAAcC,GACjB2B,GAAIC,cACJ/E,KAAM6C,EAAK7C,KACXoM,UAAW0H,KAAKC,MAChB1R,MAAO,CAAErC,KAAM,IAAKoH,MAzcJ,QA0chBwF,UAAW9K,EAAI0Q,SACf/F,cAGJ0G,EAAStQ,EAAMuQ,EAAStR,GACxBkN,EAAQmJ,QAAQ,CAAEC,SAAW,WAAUhF,EAAQtO,GAAMH,OAAO,IAC5DpD,YAAiB6R,EAAQpT,UAuQjB,OAAL2E,QAAK,IAALA,OAAA,EAAAA,EAAOiP,WA1FR,yBAAKzT,UAAY,kBAAgBM,EAASqH,mBAAqB,gBAAkB,IAAMpB,IAAK+I,GAC1F,kBAAC,EAAD,CAAU5M,KAAM8B,EAAM9B,OACtB,yBAAK1C,UAAU,wBACb,yBAAKA,UAAU,uBACb,4BAAQA,UAAU,uCAAuCkG,QAASwL,EAAS5R,MAAM,WAC/EoY,SAAUrI,EAAczK,SAAWlD,EAAM+E,OAAS,SAClD,kBAACrH,EAAA,EAAD,CAAMC,KAAK,WAEb,4BAAQG,UAAU,mCAAmCwO,SAAUqF,EAAc5M,MAAO/E,EAAMrC,KAAMqY,SAAUrI,EAAczK,SACtH,4BAAQ6B,MAAM,SAAShH,MAAO,CAAEkY,QAAS,SAAWxU,KAAKC,MAAoB,IAAd1B,EAAM+E,MAtoB3D,QAsoBV,KACA,4BAAQA,MAAM,aAAd,aACA,4BAAQA,MAAM,YAAd,YACA,4BAAQA,MAAM,OAAd,OACA,4BAAQA,MAAM,QAAd,OACA,4BAAQA,MAAM,KAAd,QACA,4BAAQA,MAAM,OAAd,QACA,4BAAQA,MAAM,KAAd,QACA,4BAAQA,MAAM,KAAd,QACA,4BAAQA,MAAM,KAAd,SAEF,4BAAQjH,UAAU,uCAAuCkG,QAASuL,EAAQ3R,MAAM,UAC9EoY,SAAUrI,EAAczK,SAAWlD,EAAM+E,OAAS,QAClD,kBAACrH,EAAA,EAAD,CAAMC,KAAK,WAGf,yBAAKG,UAAU,uBACb,4BAAQA,UAAU,uCAChBkG,QAAS+L,EAAciG,SAAU1T,EAAM9B,KAAK8J,YAAc,GAC1D,kBAAC5M,EAAA,EAAD,CAAMC,KAAK,cAEb,yBAAKG,UAAU,sCAAsCkG,QAASwO,IAC5D,2BAAO3N,KAAK,OAAOqR,UAAU,UAAUpY,UAAU,kCAAkCwO,SAAUiG,GAAmBxN,MAAOuF,EACrH6L,OAAQjE,GAAiBkE,QAASzD,GAAkB0D,UAAWrE,GAAoBjU,MAAO,CAAEe,MAAUwD,EAAM9B,KAAK8J,WAAWgB,WAAW/J,OAAnC,QACtG,mCAASe,EAAM9B,KAAK+J,YAEtB,4BAAQzM,UAAU,uCAChBkG,QAASgM,EAAUgG,SAAU1T,EAAM9B,KAAK8J,YAAchI,EAAM9B,KAAK+J,WACjE,kBAAC7M,EAAA,EAAD,CAAMC,KAAK,kBAIjB,kBAACsE,EAAA,EAAD,CACEC,UAAW,CAAEpE,UAAW,qCACxBqE,OAAQ,CACNiC,QAAS,kBAAC1G,EAAA,EAAD,CAAMC,KAAK,aACpBC,MAAO,WACPE,UAAW,6BAEbsE,KAAM,CAAEtE,UAAW,4BACnB,2BAAOA,UAAU,gCACf,2BAAO+G,KAAK,WAAW/G,UAAU,yBAC/BH,KAAK,eACL2O,SAAU2G,GACVC,QAAS9U,EAASoH,eACpB,yBAAK1H,UAAU,YACb,yBAAKA,UAAU,mBAEjB,0BAAMA,UAAU,kBAAhB,wBAEF,2BAAOA,UAAU,gCACf,2BAAO+G,KAAK,WAAW/G,UAAU,yBAC/BH,KAAK,qBACL2O,SAAU2G,GACVC,QAAS9U,EAASqH,qBACpB,yBAAK3H,UAAU,YACb,yBAAKA,UAAU,mBAEjB,0BAAMA,UAAU,kBAAhB,2BAGJ,kBAAC,IAAD,CAAMqM,GAAG,IAAIrM,UAAU,4BAA4BF,MAAM,QACvD,kBAACF,EAAA,EAAD,CAAMC,KAAK,WAoBf,yBAAKG,UAAY,cAAYM,EAASoH,aAAe,UAAY,IAAMnB,IAAK8I","file":"static/js/3.1d195a0a.chunk.js","sourcesContent":["import React from \"react\";\n\nexport default function Icon({ name, title, size = \"20px\", className, style = {} }) {\n  const icons = {\n    grid: `M16,5V11H21V5M10,11H15V5H10M16,18H21V12H16M10,18H15V12H10M4,18H9V12H4M4,11H9V5H4V11Z`,\n    list: `M9,5V9H21V5M9,19H21V15H9M9,14H21V10H9M4,9H8V5H4M4,19H8V15H4M4,14H8V10H4V14Z`,\n    trash: `M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z`,\n    settings: `M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z`,\n    menu: `M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z`,\n    close: `M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z`,\n    \"dots-vertical\": `M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z`,\n    upload: `M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z`,\n    \"circle-cross\": `M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z`,\n    \"circle-check\": `M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z`,\n    bookshelf: `M9 3V18H12V3H9M12 5L16 18L19 17L15 4L12 5M5 5V18H8V5H5M3 19V21H21V19H3Z`,\n    book: `M6.012,18H21V4c0-1.104-0.896-2-2-2H6C4.794,2,3,2.799,3,5v3v6v3v2c0,2.201,1.794,3,3,3h15v-2H6.012 C5.55,19.988,5,19.805,5,19S5.55,18.012,6.012,18z M8,6h9v2H8V6z`,\n    \"open-book\": `M19 2L14 6.5V17.5L19 13V2M6.5 5C4.55 5 2.45 5.4 1 6.5V21.16C1 21.41 1.25 21.66 1.5 21.66C1.6 21.66 1.65 21.59 1.75 21.59C3.1 20.94 5.05 20.5 6.5 20.5C8.45 20.5 10.55 20.9 12 22C13.35 21.15 15.8 20.5 17.5 20.5C19.15 20.5 20.85 20.81 22.25 21.56C22.35 21.61 22.4 21.59 22.5 21.59C22.75 21.59 23 21.34 23 21.09V6.5C22.4 6.05 21.75 5.75 21 5.5V19C19.9 18.65 18.7 18.5 17.5 18.5C15.8 18.5 13.35 19.15 12 20V6.5C10.55 5.4 8.45 5 6.5 5Z`,\n    \"book-question-mark\": `M19,2H6A2.91,2.91,0,0,0,3,5V19a2.91,2.91,0,0,0,3,3H21V20H6a1,1,0,1,1,0-2H21V4A2,2,0,0,0,19,2ZM13.09,16h-1.8V14.2h1.8Zm2.1-6.2c-.5.6-1.3,1-1.7,1.5a2.54,2.54,0,0,0-.4,1.7h-1.8a4.52,4.52,0,0,1,.4-2.45,7.22,7.22,0,0,1,1.7-1.35c1.45-1.34,1.09-3.24-.9-3.4a1.8,1.8,0,0,0-1.8,1.8H8.89A3.6,3.6,0,0,1,12.49,4,3.48,3.48,0,0,1,15.19,9.8Z`,\n    \"book-check-mark\": `M19,2H6A2.91,2.91,0,0,0,3,5V19a2.91,2.91,0,0,0,3,3H21V20H6a1,1,0,1,1,0-2H21V4A2,2,0,0,0,19,2ZM9.61,15.75,5,11.15,7.1,9.06l2.51,2.51,7.31-7.32L19,6.34Z`,\n    \"menu-down\": `M7,10L12,15L17,10H7Z`,\n    \"reset\": `M12,6V9L16,5L12,1V4A8,8 0 0,0 4,12C4,13.57 4.46,15.03 5.24,16.26L6.7,14.8C6.25,13.97 6,13 6,12A6,6 0 0,1 12,6M18.76,7.74L17.3,9.2C17.74,10.04 18,11 18,12A6,6 0 0,1 12,18V15L8,19L12,23V20A8,8 0 0,0 20,12C20,10.43 19.54,8.97 18.76,7.74Z`,\n    plus: `M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z`,\n    minus: `M19,13H5V11H19V13Z`,\n    \"arrow-up\": `M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z`,\n    \"arrow-down\": `M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z`,\n    info: `M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z`,\n    exit: `M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z`\n  };\n  style = { ...style, width: size, height: size };\n\n  return (\n    <svg viewBox=\"0 0 24 24\" className={className} style={style}>\n      {title && <title>{title}</title>}\n      <path d={icons[name]} />\n    </svg>\n  );\n}\n","function setDocumentTitle(title) {\n  document.title = `${title} | ModestRead`;\n}\n\nfunction classNames(...classNames) {\n  return classNames.join(\" \").trimEnd();\n}\n\nasync function pageToDataURL(pdf) {\n  const DEFAULT_SCALE = 0.4;\n  const page = await pdf.getPage(1);\n  const canvas = document.createElement(\"canvas\");\n  const maxWidth = 162;\n  const maxHeight = 240;\n  let viewport = page.getViewport({ scale: DEFAULT_SCALE });\n\n  if (viewport.width < maxWidth) {\n    viewport = page.getViewport({ scale: DEFAULT_SCALE * maxWidth / viewport.width });\n  }\n  else if (viewport.height > maxHeight) {\n    viewport = page.getViewport({ scale: DEFAULT_SCALE * maxHeight / viewport.height });\n  }\n  canvas.width = viewport.width;\n  canvas.height = viewport.height;\n\n  await page.render({ canvasContext: canvas.getContext(\"2d\"), viewport }).promise;\n  return canvas.toDataURL(\"image/jpeg\", 0.8);\n}\n\nasync function getPdfInstance(file, pdfjs) {\n  const arrayBuffer = await file.arrayBuffer();\n  return pdfjs.getDocument(new Uint8Array(arrayBuffer)).promise;\n}\n\nfunction parseMetadata(metadata) {\n  const data = {};\n\n  if (metadata.info.Title) {\n    data.title = metadata.info.Title;\n  }\n\n  if (metadata.info.Author) {\n    data.author = metadata.info.Author;\n  }\n  return data;\n}\n\nfunction getFileSizeString(bytes) {\n  const suffixes = [\"B\", \"kB\", \"MB\", \"GB\"];\n  let size = bytes;\n  let l = 0;\n\n  while (l < suffixes.length) {\n    if (size < 1000) {\n      break;\n    }\n    else {\n      size /= 1000;\n    }\n    l += 1;\n  }\n  size = l > 0 ? size.toFixed(1) : Math.round(size);\n  return `${size} ${suffixes[l]}`;\n}\n\nexport {\n  setDocumentTitle,\n  classNames,\n  pageToDataURL,\n  getPdfInstance,\n  parseMetadata,\n  getFileSizeString\n};\n","import BannerImage from \"./BannerImage.js\";\nexport default BannerImage;\n","import React from \"react\";\nimport iconFull from \"../../assets/icon-text.svg\";\nimport \"./banner-image.scss\";\n\nexport default function BannerImage() {\n  return <img src={iconFull} className=\"banner-image\" alt=\"\"/>;\n}\n","module.exports = __webpack_public_path__ + \"static/media/icon-text.9dc879ec.svg\";","import Dropdown from \"./Dropdown.js\";\nexport default Dropdown;\n","import React, { useState, useEffect, useRef, useCallback } from \"react\";\nimport \"./dropdown.scss\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport default function Dropdown({ container, toggle, body, children }) {\n  const [state, setState] = useState({ id: uuidv4() });\n  const memoizedWindowClickHandler = useCallback(handleWindowClick, [state.id]);\n  const isMounted = useRef(false);\n  const drop = useRef(null);\n\n  useEffect(() => {\n    isMounted.current = true;\n\n    return () => {\n      isMounted.current = false;\n      window.removeEventListener(\"click\", memoizedWindowClickHandler);\n    };\n  }, [memoizedWindowClickHandler]);\n\n  useEffect(() => {\n    if (state.reveal) {\n      const viewportHeight = document.documentElement.offsetHeight;\n      const height = drop.current.getBoundingClientRect().height;\n\n      setState({\n        ...state,\n        onTop: state.top + height > viewportHeight,\n        visible: true\n      });\n    }\n  }, [state.reveal]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  function toggleDropdown({ currentTarget }) {\n    let top = 0;\n\n    if (state.visible) {\n      window.removeEventListener(\"click\", memoizedWindowClickHandler);\n    }\n    else {\n      window.addEventListener(\"click\", memoizedWindowClickHandler);\n      top = currentTarget.getBoundingClientRect().bottom;\n    }\n    setState({\n      id: state.id,\n      visible: false,\n      reveal: !state.visible,\n      top,\n      onTop: false\n    });\n  }\n\n  function handleWindowClick({ target }) {\n    const closestContainer = target.closest(\".dropdown-container\");\n    let hideDropdown = true;\n\n    if (closestContainer?.id === state.id) {\n      if (target.closest(\"[data-dropdown-keep]\")) {\n        hideDropdown = false;\n      }\n      else {\n        hideDropdown = target.closest(\"a\") || target.closest(\".dropdown-btn\");\n      }\n    }\n\n    if (hideDropdown) {\n      if (isMounted.current) {\n        setState({ id: state.id, visible: false, reveal: false });\n      }\n      window.removeEventListener(\"click\", memoizedWindowClickHandler);\n    }\n  }\n\n  return (\n    <div id={state.id} className={`dropdown-container${container ? ` ${container.className}` : \"\"}`}>\n      <button onClick={toggleDropdown}\n        title={toggle.title}\n        className={`${toggle.className}${state.visible ? \" active\" : \"\"}`}>\n        {toggle.content}\n      </button>\n      <div ref={drop} className={`dropdown${body ? ` ${body.className}` : \"\"}${state.reveal ? \" reveal\" : \"\"}${state.visible ? \" visible\" : \"\"}${state.onTop ? \" top\" : \"\"}`}>{children}</div>\n    </div>\n  );\n}\n","import Notification from \"./Notification.js\";\nexport default Notification;\n","import React, { useState, useEffect } from \"react\";\nimport \"./notification.scss\";\nimport { classNames } from \"../../utils\";\nimport Icon from \"../Icon\";\n\nexport default function Notification({ notification, expandable, margin, children, dismiss }) {\n  const [state, setState] = useState(notification);\n  const [expanded, setExpanded] = useState(false);\n  const type = notification.type || \"negative\";\n\n  useEffect(() => {\n    if (!state.flashing && state !== notification) {\n      if (state.value !== notification.value) {\n        setState(notification);\n        return;\n      }\n      setState({ ...state, flashing: true });\n\n      setTimeout(() => {\n        setState(notification);\n      }, 640);\n    }\n  }, [state, notification]);\n\n  function toggleExpanded() {\n    setExpanded(!expanded);\n  }\n\n  return (\n    <div className={classNames(\"notification\", type, margin ? `margin-${margin}` : \"\", expanded ? \"expanded\" : \"\", state.flashing ? \"flash\" : \"\")}>\n      <Icon name={type === \"negative\" ? \"circle-cross\" : \"circle-check\"} className=\"notification-icon\" size=\"24px\"/>\n      {expandable ? (\n        <div className=\"notification-expandable-content-container\">\n          <div className=\"notification-expandable-content\">\n            <span>{notification.value}</span>\n            <button className=\"btn icon-btn notification-btn notification-expand-btn\"\n              onClick={toggleExpanded} title=\"Details\"\n              style={{ transform: `rotateZ(${expanded ? \"180deg\" : \"0\"})`}}>\n              <Icon name=\"menu-down\"/>\n            </button>\n          </div>\n          {expanded && children}\n        </div>\n      ) : <span className=\"notification-text\">{state.value}</span>}\n      <button type=\"button\" className=\"btn icon-btn notification-btn notification-dismiss-btn\"\n        onClick={dismiss} title=\"Dismiss\">\n        <Icon name=\"close\"/>\n      </button>\n    </div>\n  );\n}\n","const settings = JSON.parse(localStorage.getItem(\"settings\")) || {\n  showCategories: false,\n  layoutType: \"grid\",\n  invertColors: false,\n  keepToolbarVisible: false\n};\n\nfunction getSettings() {\n  return settings;\n}\n\nfunction setSetting(key, value) {\n  settings[key] = value;\n  localStorage.setItem(\"settings\", JSON.stringify(settings));\n}\n\nexport {\n  getSettings,\n  setSetting\n};\n","class Store {\r\n    constructor(dbName = 'keyval-store', storeName = 'keyval') {\r\n        this.storeName = storeName;\r\n        this._dbp = new Promise((resolve, reject) => {\r\n            const openreq = indexedDB.open(dbName, 1);\r\n            openreq.onerror = () => reject(openreq.error);\r\n            openreq.onsuccess = () => resolve(openreq.result);\r\n            // First time setup: create an empty object store\r\n            openreq.onupgradeneeded = () => {\r\n                openreq.result.createObjectStore(storeName);\r\n            };\r\n        });\r\n    }\r\n    _withIDBStore(type, callback) {\r\n        return this._dbp.then(db => new Promise((resolve, reject) => {\r\n            const transaction = db.transaction(this.storeName, type);\r\n            transaction.oncomplete = () => resolve();\r\n            transaction.onabort = transaction.onerror = () => reject(transaction.error);\r\n            callback(transaction.objectStore(this.storeName));\r\n        }));\r\n    }\r\n}\r\nlet store;\r\nfunction getDefaultStore() {\r\n    if (!store)\r\n        store = new Store();\r\n    return store;\r\n}\r\nfunction get(key, store = getDefaultStore()) {\r\n    let req;\r\n    return store._withIDBStore('readonly', store => {\r\n        req = store.get(key);\r\n    }).then(() => req.result);\r\n}\r\nfunction set(key, value, store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.put(value, key);\r\n    });\r\n}\r\nfunction del(key, store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.delete(key);\r\n    });\r\n}\r\nfunction clear(store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.clear();\r\n    });\r\n}\r\nfunction keys(store = getDefaultStore()) {\r\n    const keys = [];\r\n    return store._withIDBStore('readonly', store => {\r\n        // This would be store.getAllKeys(), but it isn't supported by Edge or Safari.\r\n        // And openKeyCursor isn't supported by Safari.\r\n        (store.openKeyCursor || store.openCursor).call(store).onsuccess = function () {\r\n            if (!this.result)\r\n                return;\r\n            keys.push(this.result.key);\r\n            this.result.continue();\r\n        };\r\n    }).then(() => keys);\r\n}\n\nexport { Store, get, set, del, clear, keys };\n","import { Store, set, get, keys, del } from \"idb-keyval\";\n\nconst store = new Store(\"ModestKeep\", \"files\");\n\nfunction fetchIDBFiles() {\n  return keys(store).then(keys => Promise.all(keys.map(fetchIDBFile)))\n    .then(sortFiles)\n    .catch(e => {\n      console.log(e);\n      return [];\n    });\n}\n\nfunction fetchIDBFile(id) {\n  return get(id, store);\n}\n\nfunction saveFile(snippet) {\n  set(snippet.id, snippet, store);\n}\n\nfunction deleteIDBFile(id) {\n  return del(id, store).then(() => true);\n}\n\nfunction sortFiles(files) {\n  const [reading, rest] = files.reduce((arr, file) => {\n    if (file.status === \"reading\") {\n      arr[0].push(file);\n    }\n    else {\n      arr[1].push(file);\n    }\n    return arr;\n  }, [[], []]);\n\n  return sortReadingFiles(reading).concat(sortRestFiles(rest));\n}\n\nfunction sortReadingFiles(files) {\n  return files.sort((a, b) => {\n    return b.accessedAt - a.accessedAt;\n  });\n}\n\nfunction sortRestFiles(files) {\n  return files.sort((a, b) => {\n    return a.createdAt - b.createdAt;\n  });\n}\n\nexport {\n  fetchIDBFiles,\n  fetchIDBFile,\n  saveFile,\n  deleteIDBFile,\n  sortFiles\n};\n","import FileCard from \"./FileCard.js\";\nexport default FileCard;\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport \"./file-card.scss\";\n\nexport default function FileCard({ file, showLink, children }) {\n  return (\n    <li className=\"file-card\">\n      {showLink ? (\n        <Link to={`/viewer/${file.id}`} className=\"file-card-left\" title={`Open ${file.name}`}>\n          <img src={file.coverImage} className=\"file-card-image\" alt=\"\"/>\n        </Link>\n      ) : <img src={file.coverImage} className=\"file-card-left file-card-image\" alt=\"\"/>}\n      <div className=\"file-card-info\">\n        <div className=\"file-card-title\">{file.title || file.name}</div>\n        {file.author && <div className=\"file-card-author\">{file.author}</div>}\n        <div className=\"file-card-secondary-info\">\n          {file.title && <div className=\"file-card-secondary-info-item file-card-filename\">{file.name}</div>}\n          <div className=\"file-card-secondary-info-item\">{file.sizeString}</div>\n        </div>\n        <div className=\"file-card-progress-container\"\n          title={`${file.pageNumber} of ${file.pageCount} page${file.pageCount === 1 ? \"\" : \"s\"} read`}>\n          <div className=\"file-card-progress\">\n            <div className=\"file-card-progress-bar\" style={{ left: `${(file.pageNumber - 1) / file.pageCount * 100}%` }}></div>\n          </div>\n        </div>\n        <div className=\"file-card-bottom\">{children}</div>\n      </div>\n    </li>\n  );\n}\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  if (!getRandomValues) {\n    throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","import FilePreview from \"./FilePreview.js\";\nexport default FilePreview;\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport Icon from \"../../Icon\";\nimport Notification from \"../../Notification\";\nimport BannerImage from \"../../BannerImage\";\nimport FileCard from \"../../FileCard\";\nimport \"./file-preview.scss\";\n\nexport default function FilePreview({ file, notification, dismissNotification, handleFileUpload, loadNewFile }) {\n  return (\n    <div className=\"viewer-file-preview-container\">\n      <BannerImage/>\n      <div className=\"viewer-file-preview\">\n        {notification?.type === \"negative\" && (\n          <Notification notification={notification} margin=\"bottom\" dismiss={dismissNotification}/>\n        )}\n        <FileCard file={file}>\n          <Link to=\"/\" className=\"btn icon-btn\" title=\"Back to files\">\n            <Icon name=\"bookshelf\" size=\"24px\"/>\n          </Link>\n          <label className=\"btn viewer-file-preview-import-btn\">\n            <input type=\"file\" onChange={handleFileUpload} className=\"sr-only\" accept=\"application/pdf\"/>\n            <span>Select File</span>\n          </label>\n        </FileCard>\n        {notification?.type === \"warning\" && (\n          <div className=\"viewer-file-preview-warning\">\n            <div className=\"viewer-file-preview-warning-main\">\n              <Icon name=\"info\" className=\"viewer-file-preview-warning-icon\" size=\"24px\"/>\n              <p className=\"viewer-file-preview-warning-message\">{notification.value}</p>\n            </div>\n            <div className=\"viewer-file-preview-warning-bottom\">\n              <button className=\"btn text-btn viewer-file-preview-warning-btn\" onClick={dismissNotification}>No</button>\n              <button className=\"btn viewer-file-preview-warning-btn\" onClick={loadNewFile}>Yes</button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","import FileInfo from \"./FileInfo.js\";\nexport default FileInfo;\n","import React from \"react\";\nimport Icon from \"../../Icon\";\nimport Dropdown from \"../../Dropdown\";\nimport \"./file-info.scss\";\n\nexport default function FileInfo({ file }) {\n  return (\n    <Dropdown\n      toggle={{\n        content: <Icon name=\"info\"/>,\n        title: \"Information\",\n        className: \"btn icon-btn icon-btn-alt\"\n      }}\n      body={{ className: \"file-info\" }}>\n      <img src={file.coverImage} className=\"file-info-image\" alt=\"\"/>\n      <div>\n        <div className=\"file-info-details-item\">\n          <span>File name:</span>\n          <span>{file.name}</span>\n        </div>\n        <div className=\"file-info-details-item\">\n          <span>File size:</span>\n          <span>{file.sizeString}</span>\n        </div>\n        <div className=\"file-info-details-item\">\n          <span>Title: </span>\n          <span>{file.title || \"-\"}</span>\n        </div>\n        <div className=\"file-info-details-item\">\n          <span>Author:</span>\n          <span>{file.author || \"-\"}</span>\n        </div>\n        <div className=\"file-info-details-item\">\n          <span>Page count:</span>\n          <span>{file.pageCount}</span>\n        </div>\n      </div>\n    </Dropdown>\n  );\n}\n","import NoFileNotice from \"./NoFileNotice.js\";\nexport default NoFileNotice;\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport Icon from \"../../Icon\";\nimport BannerImage from \"../../BannerImage\";\nimport \"./no-file-notice.scss\";\n\nexport default function NoFileNotice() {\n  return (\n    <div className=\"no-file-notice\">\n      <BannerImage/>\n      <p className=\"no-file-notice-message\">File not found.</p>\n      <Link to=\"/\" className=\"btn icon-text-btn primary-btn\">\n        <Icon name=\"bookshelf\" size=\"24px\"/>\n        <span>Back to Files</span>\n      </Link>\n    </div>\n  );\n}\n","import Viewer from \"./Viewer.js\";\nexport default Viewer;\n","import React, { useState, useEffect, useRef, useCallback } from \"react\";\nimport { Link, useHistory, useParams } from \"react-router-dom\";\nimport * as pdfjs from \"pdfjs-dist/webpack\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { setDocumentTitle, pageToDataURL, getPdfInstance, parseMetadata } from \"../../utils\";\nimport { fetchIDBFiles, saveFile, fetchIDBFile } from \"../../services/fileIDBService\";\nimport { getSettings, setSetting } from \"../../services/settingsService\";\nimport Dropdown from \"../Dropdown\";\nimport Icon from \"../Icon\";\nimport FilePreview from \"./FilePreview\";\nimport FileInfo from \"./FileInfo\";\nimport NoFileNotice from \"./NoFileNotice\";\nimport \"./viewer.scss\";\n\nexport default function Viewer() {\n  const DEFAUlT_SCALE = 1.3333;\n  const history = useHistory();\n  const { id } = useParams();\n  const [state, setState] = useState(null);\n  const [pageNumber, setPageNumber] = useState(1);\n  const [scale, setScale] = useState({ name: \"1\", value: DEFAUlT_SCALE });\n  const [fileLoadMessage, setFileLoadMessage] = useState(null);\n  const [settings, setSettings] = useState({});\n  const pdfRef = useRef(null);\n  const toolbarRef = useRef(null);\n  const keepToolbarVisible = useRef(false);\n  const toolbarScrollOffset = useRef(0);\n  const pageRendering = useRef(false);\n  const pendingPages = useRef([]);\n  const observer = useRef(null);\n  const scrollTimeout = useRef(0);\n  const updatingPageNumber = useRef(false);\n  const updatingPages = useRef(false);\n  const scrollDirection = useRef(0);\n  const ctrlPressed = useRef(false);\n  const memoizedScrollHandler = useCallback(handleScroll, [scale]);\n  const memoizedMouseMoveHandler = useCallback(handeMouseMove, [scale]);\n  const memoizedWheelHandler = useCallback(handleWheel, [scale]);\n  const memoizedKeyUpHandler = useCallback(handleKeyUp, [scale]);\n  const memoizedKeyDownHandler = useCallback(handleKeyDown, [scale, pageNumber]);\n\n  useEffect(() => {\n    init();\n\n    return () => {\n      document.body.style.overscrollBehavior = \"\";\n    };\n  }, [id]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => {\n    if (!state || !state.instance) {\n      return;\n    }\n    const pdf = pdfRef.current;\n\n    pdf.addEventListener(\"mousemove\", memoizedMouseMoveHandler);\n    window.addEventListener(\"scroll\", memoizedScrollHandler);\n    window.addEventListener(\"wheel\", memoizedWheelHandler, { passive: false });\n    window.addEventListener(\"keyup\", memoizedKeyUpHandler);\n\n    return () => {\n      pdf.removeEventListener(\"mousemove\", memoizedMouseMoveHandler);\n      window.removeEventListener(\"scroll\", memoizedScrollHandler);\n      window.removeEventListener(\"wheel\", memoizedWheelHandler, { passive: false });\n      window.removeEventListener(\"keyup\", memoizedKeyUpHandler);\n    };\n  }, [memoizedScrollHandler, memoizedMouseMoveHandler, memoizedWheelHandler, memoizedKeyUpHandler]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => {\n    window.addEventListener(\"keydown\", memoizedKeyDownHandler);\n\n    return () => {\n      window.removeEventListener(\"keydown\", memoizedKeyDownHandler);\n    };\n  }, [memoizedKeyDownHandler]);\n\n  useEffect(() => {\n    if (!state || !state.instance) {\n      return;\n    }\n    function updatePages(scaleValue) {\n      for (const [index, element] of Object.entries(pdfRef.current.children)) {\n        const pageDimension = state.pageDimensions[index];\n        const w = Math.floor(pageDimension.width * scaleValue);\n        const h = Math.floor(pageDimension.height * scaleValue);\n\n        element.style.width = `${w}px`;\n        element.style.height = `${h}px`;\n\n        if (element.hasAttribute(\"data-loaded\")) {\n          const canvas = element.firstElementChild;\n          const { width } = canvas;\n\n          if (w === width) {\n            canvas.style.width = \"\";\n            canvas.style.height = \"\";\n            element.removeAttribute(\"data-rerender-needed\");\n          }\n          else {\n            canvas.style.width = `${w}px`;\n            canvas.style.height = `${h}px`;\n            element.setAttribute(\"data-rerender-needed\", true);\n          }\n        }\n      }\n    }\n\n    function updatePagesWithNewScale(newScale) {\n      const scrollLeft = document.documentElement.scrollLeft;\n      const { top } = getPageElementBox(pageNumber);\n\n      updatePages(newScale.value);\n\n      state.file.scale = newScale;\n      state.views = getPageViews();\n      state.file.scrollTop = state.views[pageNumber - 1].top - top * newScale.value / state.file.scale.value;\n      state.file.scrollLeft = scrollLeft * newScale.value / state.file.scale.value;\n      state.pagesInViewport = getVisiblePageCount(state.views);\n\n      window.scrollTo(state.file.scrollLeft, state.file.scrollTop);\n      setState({ ...state });\n      saveFile(state.file);\n    }\n\n    function callback(entries) {\n      entries.forEach(({ isIntersecting, target }) => {\n        if (!isIntersecting || (target.hasAttribute(\"data-loaded\") && !target.hasAttribute(\"data-rerender-needed\"))) {\n          return;\n        }\n\n        if (pageRendering.current) {\n          pendingPages.current.push(target);\n        }\n        else {\n          pageRendering.current = true;\n          target.setAttribute(\"data-loaded\", \"true\");\n          renderPageContent(target);\n        }\n      });\n    }\n\n    async function renderPageContent(container) {\n      const number = parseInt(container.getAttribute(\"data-page-number\"), 10);\n      const pageDimension = state.pageDimensions[number - 1];\n      const w = Math.floor(pageDimension.width * scale.value);\n      const h = Math.floor(pageDimension.height * scale.value);\n      const canvas = document.createElement(\"canvas\");\n      let textLayerDiv = null;\n      let oldCanvas = null;\n\n      canvas.classList.add(\"viewer-page-canvas\");\n\n      if (container.hasAttribute(\"data-rerender-needed\")) {\n        oldCanvas = container.firstElementChild;\n        textLayerDiv = container.lastElementChild;\n        textLayerDiv.innerHTML = \"\";\n\n        container.removeAttribute(\"data-rerender-needed\");\n      }\n      else {\n        textLayerDiv = document.createElement(\"div\");\n        textLayerDiv.classList.add(\"viewer-page-text\");\n\n        container.appendChild(canvas);\n        container.appendChild(textLayerDiv);\n      }\n      const page = await state.instance.getPage(number);\n      const viewport = page.getViewport({ scale: scale.value });\n\n      canvas.width = w % 2 === 0 ? w : w + 1;\n      canvas.height = h + 1;\n      textLayerDiv.style.width = `${w}px`;\n      textLayerDiv.style.height = `${h}px`;\n\n      await page.render({\n        canvasContext: canvas.getContext(\"2d\"),\n        enableWebGL: true,\n        viewport\n      }).promise;\n\n      requestAnimationFrame(async () => {\n        pdfjs.renderTextLayer({\n          textContent: await page.getTextContent(),\n          container: textLayerDiv,\n          viewport,\n          textDivs: []\n        });\n      });\n\n      if (oldCanvas) {\n        container.replaceChild(canvas, oldCanvas);\n      }\n\n      if (pendingPages.current.length) {\n        while (pendingPages.current.length) {\n          const element = scrollDirection.current === 1 ? pendingPages.current.pop() : pendingPages.current.shift();\n          element.setAttribute(\"data-loaded\", \"true\");\n          renderPageContent(element);\n        }\n      }\n      else {\n        pageRendering.current = false;\n      }\n    }\n\n    updatePagesWithNewScale(scale);\n\n    if (observer.current) {\n      observer.current.disconnect();\n    }\n    observer.current = new IntersectionObserver(callback, {\n      rootMargin: `${state.maxHeight * state.file.scale.value}px 0px`\n    });\n    Array.from(pdfRef.current.children).forEach(element => {\n      observer.current.observe(element);\n    });\n    updatingPages.current = false;\n  }, [scale]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  async function init() {\n    if (history.location.state) {\n      return;\n    }\n    const file = await fetchIDBFile(id);\n\n    if (file) {\n      setState({ file, filePreviewVisible: true });\n      setSettings(getSettings());\n      setDocumentTitle(file.name);\n      document.body.style.overscrollBehavior = \"none\";\n    }\n    else {\n      setState({ error: true });\n      setDocumentTitle(\"Error\");\n    }\n  }\n\n  function handleScroll() {\n    if (updatingPageNumber.current) {\n      return;\n    }\n    updatingPageNumber.current = true;\n\n    requestAnimationFrame(() => {\n      const { scrollTop, scrollLeft } = document.documentElement;\n      const oldPageNumber = state.file.pageNumber;\n      const scrollDiff = state.file.scrollTop - scrollTop;\n      scrollDirection.current = scrollTop > state.file.scrollTop ? 1 : -1;\n      state.file.scrollTop = scrollTop < 0 ? 0 : scrollTop;\n      state.file.scrollLeft = scrollLeft;\n      state.file.pageNumber = getVisiblePageNumber(state.views, state.file.scrollTop);\n\n      if (!keepToolbarVisible.current) {\n        if (scrollDirection.current === 1) {\n          hideToolbar();\n        }\n        else if (!state.file.scrollTop) {\n          revealToolbar();\n        }\n        else if (toolbarScrollOffset.current > 100) {\n          revealToolbar();\n        }\n        else {\n          toolbarScrollOffset.current += scrollDiff;\n        }\n      }\n      keepToolbarVisible.current = false;\n\n      clearTimeout(scrollTimeout.current);\n      scrollTimeout.current = setTimeout(() => {\n        saveFile(state.file);\n      }, 1000);\n\n      if (state.file.pageNumber !== oldPageNumber) {\n        setPageNumber(state.file.pageNumber);\n        setState({ ...state });\n      }\n      updatingPageNumber.current = false;\n    });\n  }\n\n  function handeMouseMove(event) {\n    if (event.clientY < 80 &&\n      event.clientX < event.currentTarget.clientWidth &&\n      toolbarRef.current.classList.contains(\"hidden\")\n    ) {\n      toolbarRef.current.classList.remove(\"hidden\");\n\n      setTimeout(() => {\n        toolbarRef.current.classList.remove(\"hiding\");\n      }, 200);\n    }\n  }\n\n  function handleWheel(event) {\n    if (ctrlPressed.current) {\n      event.preventDefault();\n\n      if (event.wheelDelta > 0) {\n        zoomIn();\n      }\n      else {\n        zoomOut();\n      }\n    }\n  }\n\n  function handleKeyDown(event) {\n    if (event.target.nodeName === \"INPUT\") {\n      return;\n    }\n    ctrlPressed.current = event.ctrlKey;\n\n    if (event.ctrlKey) {\n      if (event.key === \"+\") {\n        zoomIn();\n        event.preventDefault();\n      }\n      if (event.key === \"-\") {\n        zoomOut();\n        event.preventDefault();\n      }\n      return;\n    }\n    const { scrollWidth, offsetWidth } = document.documentElement;\n\n    if (scrollWidth <= offsetWidth) {\n      if (event.key === \"ArrowLeft\") {\n        previousPage();\n        event.preventDefault();\n      }\n      else if (event.key === \"ArrowRight\") {\n        nextPage();\n        event.preventDefault();\n      }\n    }\n  }\n\n  function handleKeyUp(event) {\n    ctrlPressed.current = event.ctrlKey;\n  }\n\n  function revealToolbar() {\n    if (toolbarRef.current.classList.contains(\"hidden\")) {\n      toolbarScrollOffset.current = 0;\n      toolbarRef.current.classList.remove(\"hidden\");\n\n      setTimeout(() => {\n        toolbarRef.current.classList.remove(\"hiding\");\n      }, 200);\n    }\n  }\n\n  function hideToolbar() {\n    if (!toolbarRef.current.classList.contains(\"hidden\")) {\n      toolbarScrollOffset.current = 0;\n      toolbarRef.current.classList.add(\"hiding\");\n\n      setTimeout(() => {\n        toolbarRef.current.classList.add(\"hidden\");\n      }, 200);\n    }\n  }\n\n  function getPageViews() {\n    return Array.from(pdfRef.current.children).map(element => {\n      return {\n        top: element.offsetTop,\n        left: element.offsetLeft,\n        width: element.offsetWidth,\n        height: element.offsetHeight\n      };\n    });\n  }\n\n  function getVisiblePageCount(views) {\n    const count = Math.ceil(document.documentElement.offsetHeight / ((views[0].height + views[1].height) / 2));\n\n    if (count < 2) {\n      return 2;\n    }\n    return count;\n  }\n\n  async function getPageDimensions(pdf) {\n    const dimensions = [];\n\n    for (let i = 0; i < pdf.numPages; i += 1) {\n      const page = await pdf.getPage(i + 1);\n      const { width, height } = page.getViewport({ scale: 1 });\n\n      dimensions.push({ width, height });\n    }\n    return dimensions;\n  }\n\n  async function renderEmptyPage(i, scale, fragmenet, pdf) {\n    const div = document.createElement(\"div\");\n    const page = await pdf.getPage(i);\n    const viewport = page.getViewport({ scale: scale.value });\n\n    div.style.width = `${Math.floor(viewport.width)}px`;\n    div.style.height = `${Math.floor(viewport.height)}px`;\n\n    div.setAttribute(\"data-page-number\", i);\n    div.classList.add(\"viewer-page\");\n    fragmenet.appendChild(div);\n  }\n\n  async function renderEmptyPages(pdf, scale) {\n    const fragment = new DocumentFragment();\n    const promises = [];\n\n    for (let i = 0; i < pdf.numPages; i += 1) {\n      promises.push(renderEmptyPage(i + 1, scale, fragment, pdf));\n    }\n    await Promise.all(promises);\n    pdfRef.current.appendChild(fragment);\n  }\n\n  async function loadFile(file, newFile = null, pdfInstance = null) {\n    const stateFile = newFile || state.file;\n    stateFile.scale = stateFile.scale || { name: \"1\", value: DEFAUlT_SCALE };\n    stateFile.pageNumber = stateFile.pageNumber || 1;\n    const pdf = pdfInstance || await getPdfInstance(file, pdfjs);\n    const [{ maxWidth, maxHeight }, pageDimensions] = await Promise.all([\n      findBiggestDimensions(pdf),\n      getPageDimensions(pdf),\n      renderEmptyPages(pdf, stateFile.scale)\n    ]);\n\n    delete state.filePreviewVisible;\n\n    setState({\n      ...state,\n      instance: pdf,\n      pageDimensions,\n      file: stateFile,\n      maxWidth,\n      maxHeight\n    });\n\n    window.scrollTo(stateFile.scrollLeft, stateFile.scrollTop);\n    setScale(stateFile.scale);\n    setPageNumber(stateFile.pageNumber);\n\n    if (stateFile.status !== \"read\") {\n      if (stateFile.pageCount === 1) {\n        stateFile.status = \"read\";\n      }\n      else {\n        stateFile.status = \"reading\";\n      }\n    }\n    stateFile.accessedAt = Date.now();\n    saveFile(stateFile);\n  }\n\n  async function loadNewFile() {\n    const { file } = fileLoadMessage;\n    const files = await fetchIDBFiles();\n    let newFile = files.find(({ name }) => name === file.name);\n    let pdf = null;\n\n    if (!newFile) {\n      pdf = await getPdfInstance(file, pdfjs);\n      const [metadata, coverImage] = await Promise.all([pdf.getMetadata(), pageToDataURL(pdf)]);\n      newFile = {\n        ...parseMetadata(metadata),\n        id: uuidv4(),\n        name: file.name,\n        createdAt: Date.now(),\n        scale: { name: \"1\", value: DEFAUlT_SCALE },\n        pageCount: pdf.numPages,\n        coverImage\n      };\n    }\n    loadFile(file, newFile, pdf);\n    history.replace({ pathname: `/viewer/${newFile.id}`, state: true });\n    setDocumentTitle(newFile.name);\n  }\n\n  async function handleFileUpload(event) {\n    const [file] = event.target.files;\n\n    if (!file.name.endsWith(\".pdf\")) {\n      setFileLoadMessage({\n        file,\n        type: \"negative\",\n        value: \"File is not supported.\"\n      });\n    }\n    else if (file.name !== state.file.name) {\n      setFileLoadMessage({\n        file,\n        type: \"warning\",\n        value: \"File does not match currently loaded file.\\nDo you want to load it anyway?\"\n      });\n    }\n    else {\n      loadFile(file);\n    }\n    event.target.value = \"\";\n  }\n\n  async function findBiggestDimensions(pdf) {\n    let maxWidth = 0;\n    let maxHeight = 0;\n\n    for (let i = 1; i < 3; i += 1) {\n      const page = await pdf.getPage(i);\n      const { width, height } = page.getViewport({ scale: 1 });\n\n      if (width > maxWidth) {\n        maxWidth = width;\n      }\n\n      if (height > maxHeight) {\n        maxHeight = height;\n      }\n    }\n    return {\n      maxWidth: Math.floor(maxWidth),\n      maxHeight: Math.floor(maxHeight)\n    };\n  }\n\n  async function handleSelect(event) {\n    let newScale = DEFAUlT_SCALE;\n\n    if (event.target.value === \"fit-width\") {\n      const maxWidth = document.documentElement.offsetWidth - 16;\n      newScale = maxWidth / state.maxWidth;\n    }\n    else if (event.target.value === \"fit-page\") {\n      const { keepToolbarVisible } = settings;\n      const maxHeight = document.documentElement.offsetHeight - (keepToolbarVisible ? 56 : 16);\n      newScale = maxHeight / state.maxHeight;\n    }\n    else {\n      newScale = DEFAUlT_SCALE * event.target.value;\n    }\n    updatingPages.current = true;\n    setScale({ name: event.target.value, value: newScale });\n  }\n\n  function getVisiblePageNumber(views, top) {\n    for (let i = 0; i < views.length - 1; i += 1) {\n      const view = views[i];\n      const view2 = views[i + 1];\n      const offset = view.top + (view.height / 2);\n      const offset2 = view2.top + (view2.height / 2);\n\n      if (top >= offset && top <= offset2) {\n        return i + 2;\n      }\n    }\n    return 1;\n  }\n\n  function zoomOut() {\n    updatingPages.current = true;\n    setScale({ name: \"custom\", value: Math.max(scale.value / 1.1, 0.333325) });\n  }\n\n  function zoomIn() {\n    updatingPages.current = true;\n    setScale({ name: \"custom\", value: Math.min(scale.value * 1.1, 13.333) });\n  }\n\n  function previousPage() {\n    keepToolbarVisible.current = true;\n    scrollToPage(pageNumber - 1);\n  }\n\n  function nextPage() {\n    keepToolbarVisible.current = true;\n    scrollToPage(pageNumber + 1);\n  }\n\n  function handleInputKeydown(event) {\n    if (event.key === \"Enter\") {\n      event.target.blur();\n    }\n  }\n\n  function handleInputBlur(event) {\n    let number = parseInt(event.target.value, 10);\n\n    if (Number.isNaN(number)) {\n      number = state.file.pageNumber;\n    }\n    else if (number < 1) {\n      number = 1;\n    }\n    else if (number > state.file.pageCount) {\n      number = state.file.pageCount;\n    }\n    event.target.style.width = `${number.toString().length}ch`;\n\n    if (number !== pageNumber) {\n      keepToolbarVisible.current = true;\n      scrollToPage(number);\n    }\n  }\n\n  function handleInputChange(event) {\n    setPageNumber(event.target.value);\n  }\n\n  function handleInputClick(event) {\n    if (event.target !== event.currentTarget.firstElementChild) {\n      event.currentTarget.firstElementChild.focus();\n    }\n  }\n\n  function handleInputFocus(event) {\n    const width = state.file.pageCount < 1000 ? 4 : state.file.pageCount.toString().length;\n    event.target.style.width = `${width}ch`;\n    event.target.select();\n  }\n\n  function execFuncOnPageElement(number, callback) {\n    for (const element of pdfRef.current.children) {\n      if (parseInt(element.getAttribute(\"data-page-number\"), 10) === number) {\n        return callback(element);\n      }\n    }\n  }\n\n  function getPageElementBox(number) {\n    return execFuncOnPageElement(number, element => element.getBoundingClientRect());\n  }\n\n  function scrollToPage(number) {\n    execFuncOnPageElement(number, element => {\n      const offset = settings.keepToolbarVisible ? 40 : 0;\n      window.scrollTo(state.file.scrollLeft, element.offsetTop - offset);\n    });\n  }\n\n  function hideFileLoadMessage() {\n    setFileLoadMessage(null);\n  }\n\n  function handleSettingChange({ target }) {\n    setSettings({ ...settings, [target.name]: target.checked });\n    setSetting(target.name, target.checked);\n  }\n\n  function renderToolbar() {\n    return (\n      <div className={`viewer-toolbar${settings.keepToolbarVisible ? \" keep-visible\" : \"\"}`} ref={toolbarRef}>\n        <FileInfo file={state.file}/>\n        <div className=\"viewer-toolbar-tools\">\n          <div className=\"viewer-toolbar-zoom\">\n            <button className=\"btn icon-btn viewer-toolbar-tool-btn\" onClick={zoomOut} title=\"Zoom out\"\n              disabled={updatingPages.current || scale.value <= 0.333325}>\n              <Icon name=\"minus\"/>\n            </button>\n            <select className=\"input viewer-toolbar-zoom-select\" onChange={handleSelect} value={scale.name} disabled={updatingPages.current}>\n              <option value=\"custom\" style={{ display: \"none\" }}>{Math.round(scale.value * 100 / DEFAUlT_SCALE)}%</option>\n              <option value=\"fit-width\">Fit Width</option>\n              <option value=\"fit-page\">Fit Page</option>\n              <option value=\"0.5\">50%</option>\n              <option value=\"0.75\">75%</option>\n              <option value=\"1\">100%</option>\n              <option value=\"1.5\">150%</option>\n              <option value=\"2\">200%</option>\n              <option value=\"3\">300%</option>\n              <option value=\"4\">400%</option>\n            </select>\n            <button className=\"btn icon-btn viewer-toolbar-tool-btn\" onClick={zoomIn} title=\"Zoom in\"\n              disabled={updatingPages.current || scale.value >= 13.333}>\n              <Icon name=\"plus\"/>\n            </button>\n          </div>\n          <div className=\"viewer-toolbar-page\">\n            <button className=\"btn icon-btn viewer-toolbar-tool-btn\"\n              onClick={previousPage} disabled={state.file.pageNumber <= 1}>\n              <Icon name=\"arrow-up\"/>\n            </button>\n            <div className=\"viewer-toolbar-page-input-container\" onClick={handleInputClick}>\n              <input type=\"text\" inputMode=\"numeric\" className=\"input viewer-toolbar-page-input\" onChange={handleInputChange} value={pageNumber}\n                onBlur={handleInputBlur} onFocus={handleInputFocus} onKeyDown={handleInputKeydown} style={{ width: `${state.file.pageNumber.toString().length}ch`}}/>\n              <div>of {state.file.pageCount}</div>\n            </div>\n            <button className=\"btn icon-btn viewer-toolbar-tool-btn\"\n              onClick={nextPage} disabled={state.file.pageNumber >= state.file.pageCount}>\n              <Icon name=\"arrow-down\"/>\n            </button>\n          </div>\n        </div>\n        <Dropdown\n          container={{ className: \"viewer-toolbar-settings-container\" }}\n          toggle={{\n            content: <Icon name=\"settings\"/>,\n            title: \"Settings\",\n            className: \"btn icon-btn icon-btn-alt\"\n          }}\n          body={{ className: \"viewer-toolbar-settings\" }}>\n          <label className=\"viewer-toolbar-settings-item\">\n            <input type=\"checkbox\" className=\"sr-only checkbox-input\"\n              name=\"invertColors\"\n              onChange={handleSettingChange}\n              checked={settings.invertColors}/>\n            <div className=\"checkbox\">\n              <div className=\"checkbox-tick\"></div>\n            </div>\n            <span className=\"checkbox-label\">Invert page colors.</span>\n          </label>\n          <label className=\"viewer-toolbar-settings-item\">\n            <input type=\"checkbox\" className=\"sr-only checkbox-input\"\n              name=\"keepToolbarVisible\"\n              onChange={handleSettingChange}\n              checked={settings.keepToolbarVisible}/>\n            <div className=\"checkbox\">\n              <div className=\"checkbox-tick\"></div>\n            </div>\n            <span className=\"checkbox-label\">Keep toolbar visible.</span>\n          </label>\n        </Dropdown>\n        <Link to=\"/\" className=\"btn icon-btn icon-btn-alt\" title=\"Exit\">\n          <Icon name=\"exit\"/>\n        </Link>\n      </div>\n    );\n  }\n\n  if (state?.error) {\n    return (\n      <NoFileNotice/>\n    );\n  }\n\n  return (\n    <>\n      {state?.filePreviewVisible && <FilePreview file={state.file} notification={fileLoadMessage}\n        dismissNotification={hideFileLoadMessage}\n        handleFileUpload={handleFileUpload}\n        loadNewFile={loadNewFile}/>\n      }\n      {state?.instance && renderToolbar()}\n      <div className={`viewer-pdf${settings.invertColors ? \" invert\" : \"\"}`} ref={pdfRef}></div>\n    </>\n  );\n}\n"],"sourceRoot":""}