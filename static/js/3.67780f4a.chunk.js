(this["webpackJsonpmodest-read"]=this["webpackJsonpmodest-read"]||[]).push([[3,7],Array(31).concat([function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(3);n(0);function c({name:e,title:t,size:n="20px",className:c,style:r={}}){const a={grid:"M16,5V11H21V5M10,11H15V5H10M16,18H21V12H16M10,18H15V12H10M4,18H9V12H4M4,11H9V5H4V11Z",list:"M9,5V9H21V5M9,19H21V15H9M9,14H21V10H9M4,9H8V5H4M4,19H8V15H4M4,14H8V10H4V14Z",trash:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z",settings:"M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z",menu:"M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z",close:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z","dots-vertical":"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",upload:"M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z","circle-cross":"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z","circle-check":"M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z",bookshelf:"M9 3V18H12V3H9M12 5L16 18L19 17L15 4L12 5M5 5V18H8V5H5M3 19V21H21V19H3Z",book:"M6.012,18H21V4c0-1.104-0.896-2-2-2H6C4.794,2,3,2.799,3,5v3v6v3v2c0,2.201,1.794,3,3,3h15v-2H6.012 C5.55,19.988,5,19.805,5,19S5.55,18.012,6.012,18z M8,6h9v2H8V6z","open-book":"M19 2L14 6.5V17.5L19 13V2M6.5 5C4.55 5 2.45 5.4 1 6.5V21.16C1 21.41 1.25 21.66 1.5 21.66C1.6 21.66 1.65 21.59 1.75 21.59C3.1 20.94 5.05 20.5 6.5 20.5C8.45 20.5 10.55 20.9 12 22C13.35 21.15 15.8 20.5 17.5 20.5C19.15 20.5 20.85 20.81 22.25 21.56C22.35 21.61 22.4 21.59 22.5 21.59C22.75 21.59 23 21.34 23 21.09V6.5C22.4 6.05 21.75 5.75 21 5.5V19C19.9 18.65 18.7 18.5 17.5 18.5C15.8 18.5 13.35 19.15 12 20V6.5C10.55 5.4 8.45 5 6.5 5Z","book-question-mark":"M19,2H6A2.91,2.91,0,0,0,3,5V19a2.91,2.91,0,0,0,3,3H21V20H6a1,1,0,1,1,0-2H21V4A2,2,0,0,0,19,2ZM13.09,16h-1.8V14.2h1.8Zm2.1-6.2c-.5.6-1.3,1-1.7,1.5a2.54,2.54,0,0,0-.4,1.7h-1.8a4.52,4.52,0,0,1,.4-2.45,7.22,7.22,0,0,1,1.7-1.35c1.45-1.34,1.09-3.24-.9-3.4a1.8,1.8,0,0,0-1.8,1.8H8.89A3.6,3.6,0,0,1,12.49,4,3.48,3.48,0,0,1,15.19,9.8Z","book-check-mark":"M19,2H6A2.91,2.91,0,0,0,3,5V19a2.91,2.91,0,0,0,3,3H21V20H6a1,1,0,1,1,0-2H21V4A2,2,0,0,0,19,2ZM9.61,15.75,5,11.15,7.1,9.06l2.51,2.51,7.31-7.32L19,6.34Z","menu-down":"M7,10L12,15L17,10H7Z",reset:"M12,6V9L16,5L12,1V4A8,8 0 0,0 4,12C4,13.57 4.46,15.03 5.24,16.26L6.7,14.8C6.25,13.97 6,13 6,12A6,6 0 0,1 12,6M18.76,7.74L17.3,9.2C17.74,10.04 18,11 18,12A6,6 0 0,1 12,18V15L8,19L12,23V20A8,8 0 0,0 20,12C20,10.43 19.54,8.97 18.76,7.74Z",plus:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z",minus:"M19,13H5V11H19V13Z","arrow-up":"M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z","arrow-down":"M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z",info:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",exit:"M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z",sort:"M3 11H15V13H3M3 18V16H21V18M3 6H9V8H3Z",search:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z","chevron-left":"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z","chevron-right":"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z",page:"M17,22H7a2,2,0,0,1-2-2V4A2,2,0,0,1,7,2H17a2,2,0,0,1,2,2V20A2,2,0,0,1,17,22Z",pages:"M16,4H8A2,2,0,0,1,6,2H18A2,2,0,0,1,16,4Zm2,12V8a2,2,0,0,0-2-2H8A2,2,0,0,0,6,8v8a2,2,0,0,0,2,2h8A2,2,0,0,0,18,16Zm0,6a2,2,0,0,0-2-2H8a2,2,0,0,0-2,2H18Z",rotate:"M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10L15.55,5.55Z",outline:"M6 4.5A1.5 1.5 0 114.5 3 1.5 1.5 0 016 4.5zM4.5 18A1.5 1.5 0 106 19.5 1.5 1.5 0 004.5 18zm0-5A1.5 1.5 0 106 14.5 1.5 1.5 0 004.5 13zm0-5A1.5 1.5 0 106 9.5 1.5 1.5 0 004.5 8zM19 4.5A1.5 1.5 0 0017.5 3h-8A1.5 1.5 0 008 4.5 1.5 1.5 0 009.5 6h8A1.5 1.5 0 0019 4.5zm-2 5A1.5 1.5 0 0015.5 8h-6A1.5 1.5 0 008 9.5 1.5 1.5 0 009.5 11h6A1.5 1.5 0 0017 9.5zm4 5a1.5 1.5 0 00-1.5-1.5h-10A1.5 1.5 0 008 14.5 1.5 1.5 0 009.5 16h10a1.5 1.5 0 001.5-1.5zm-1 5a1.5 1.5 0 00-1.5-1.5h-9A1.5 1.5 0 008 19.5 1.5 1.5 0 009.5 21h9a1.5 1.5 0 001.5-1.5z"};return r={...r,width:n,height:n},Object(i.jsxs)("svg",{viewBox:"0 0 24 24",className:c,style:r,children:[t&&Object(i.jsx)("title",{children:t}),Object(i.jsx)("path",{d:a[e]})]})}},function(e,t,n){"use strict";function i(e){document.title=e+" | ModestRead"}function c(...e){return e.join(" ").trimEnd()}async function r(e){const t=await e.getPage(1),n=document.createElement("canvas");let i=t.getViewport({scale:.4});return i.width<162?i=t.getViewport({scale:64.8/i.width}):i.height>240&&(i=t.getViewport({scale:96/i.height})),n.width=i.width,n.height=i.height,await t.render({canvasContext:n.getContext("2d"),viewport:i}).promise,n.toDataURL("image/jpeg",.8)}async function a(e,t){const n=await e.arrayBuffer();return t.getDocument(new Uint8Array(n)).promise}function o(e){const t={};return e.info.Title&&(t.title=e.info.Title),e.info.Author&&(t.author=e.info.Author),t}function s(e){const t=["B","kB","MB","GB"];let n=e,i=0;for(;i<t.length&&!(n<1e3);)n/=1e3,i+=1;return n=i>0?n.toFixed(1):Math.round(n),`${n} ${t[i]}`}function l(e,t,n){for(const i of e)if(parseInt(i.getAttribute("data-page-number"),10)===t)return n(i)}function d(e,t){return l(t,e,(e=>e.getBoundingClientRect()))}function u(e,t,n){l(t,e,(t=>{const i=n||1===e?40:0;window.scrollTo(document.documentElement.scrollLeft,t.offsetTop-i)}))}function f(){const e=document.createElement("div"),t=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.appendChild(t),document.body.appendChild(e);const n=e.offsetWidth-t.offsetWidth;return e.remove(),n}n.d(t,"i",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return f}))},function(e,t,n){"use strict";var i=n(3),c=(n(0),n.p+"static/media/icon-text.8d796bce.svg");n(35);t.a=function(){return Object(i.jsx)("img",{src:c,className:"banner-image",alt:""})}},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return o}));const i=JSON.parse(localStorage.getItem("modest-read-settings"))||{sortBy:"last-accessed",sortOrder:1,showCategories:!1,layoutType:"grid",invertColors:!1,keepToolbarVisible:!1};function c(){return i}function r(e){return i[e]}function a(e){Object.assign(i,e),s()}function o(e,t){i[e]=t,s()}function s(){localStorage.setItem("modest-read-settings",JSON.stringify(i))}},function(e,t,n){},function(e,t,n){"use strict";var i=n(3),c=n(0),r=(n(41),n(72));t.a=function({container:e,toggle:t,body:n,children:a}){const[o,s]=Object(c.useState)({id:Object(r.a)()}),l=Object(c.useCallback)((function({target:e}){const t=e.closest(".dropdown-container");let n=!0;(null===t||void 0===t?void 0:t.id)===o.id&&(n=!e.closest("[data-dropdown-keep]")&&(e.closest("a")||e.closest(".dropdown-btn")));n&&(d.current&&s({id:o.id,visible:!1,reveal:!1}),window.removeEventListener("click",l))}),[o.id]),d=Object(c.useRef)(!1),u=Object(c.useRef)(null);return Object(c.useEffect)((()=>(d.current=!0,()=>{d.current=!1,window.removeEventListener("click",l)})),[l]),Object(c.useEffect)((()=>{if(o.reveal){const e=document.documentElement.offsetHeight,t=u.current.getBoundingClientRect().height;s({...o,onTop:o.top+t>e,visible:!0})}}),[o.reveal]),Object(i.jsxs)("div",{id:o.id,className:"dropdown-container"+(e?" "+e.className:""),children:[Object(i.jsx)("button",{onClick:function({currentTarget:e}){let t=0;o.visible?window.removeEventListener("click",l):(window.addEventListener("click",l),t=e.getBoundingClientRect().bottom),s({id:o.id,visible:!1,reveal:!o.visible,top:t,onTop:!1})},title:t.title,className:`${t.className}${o.visible?" active":""}`,children:t.content}),Object(i.jsx)("div",{ref:u,className:`dropdown${n?" "+n.className:""}${o.reveal?" reveal":""}${o.visible?" visible":""}${o.onTop?" top":""}`,children:a})]})}},function(e,t,n){"use strict";var i=n(3),c=n(0),r=(n(42),n(32)),a=n(31);t.a=function({notification:e,expandable:t,className:n="",margin:o,children:s,dismiss:l}){const[d,u]=Object(c.useState)(e),[f,b]=Object(c.useState)(!1),m=e.type||"negative";return Object(c.useEffect)((()=>{if(!d.flashing&&d!==e){if(d.value!==e.value)return void u(e);u({...d,flashing:!0}),setTimeout((()=>{u(e)}),640)}}),[d,e]),Object(i.jsxs)("div",{className:Object(r.a)("notification",n,m,o?"margin-"+o:"",f?"expanded":"",d.flashing?"flash":""),children:[Object(i.jsx)(a.a,{name:"negative"===m?"circle-cross":"circle-check",className:"notification-icon",size:"24px"}),t?Object(i.jsxs)("div",{className:"notification-expandable-content-container",children:[Object(i.jsxs)("div",{className:"notification-expandable-content",children:[Object(i.jsx)("span",{children:e.value}),Object(i.jsx)("button",{className:"btn icon-btn notification-btn notification-expand-btn",onClick:function(){b(!f)},title:"Details",style:{transform:`rotateZ(${f?"180deg":"0"})`},children:Object(i.jsx)(a.a,{name:"menu-down"})})]}),f&&s]}):Object(i.jsx)("span",{className:"notification-text",children:d.value}),Object(i.jsx)("button",{type:"button",className:"btn icon-btn notification-btn notification-dismiss-btn",onClick:l,title:"Dismiss",children:Object(i.jsx)(a.a,{name:"close"})})]})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l}));class i{constructor(e="keyval-store",t="keyval"){this.storeName=t,this._dbp=new Promise(((n,i)=>{const c=indexedDB.open(e,1);c.onerror=()=>i(c.error),c.onsuccess=()=>n(c.result),c.onupgradeneeded=()=>{c.result.createObjectStore(t)}}))}_withIDBStore(e,t){return this._dbp.then((n=>new Promise(((i,c)=>{const r=n.transaction(this.storeName,e);r.oncomplete=()=>i(),r.onabort=r.onerror=()=>c(r.error),t(r.objectStore(this.storeName))}))))}}let c;function r(){return c||(c=new i),c}function a(e,t=r()){let n;return t._withIDBStore("readonly",(t=>{n=t.get(e)})).then((()=>n.result))}function o(e,t,n=r()){return n._withIDBStore("readwrite",(n=>{n.put(t,e)}))}function s(e,t=r()){return t._withIDBStore("readwrite",(t=>{t.delete(e)}))}function l(e=r()){const t=[];return e._withIDBStore("readonly",(e=>{(e.openKeyCursor||e.openCursor).call(e).onsuccess=function(){this.result&&(t.push(this.result.key),this.result.continue())}})).then((()=>t))}},,function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return d}));var i=n(38);const c=new i.a("ModestKeep","files");function r(e){return Object(i.d)(c).then((e=>Promise.all(e.map(a)))).then((t=>e?d(t,e):t)).catch((e=>(console.log(e),[])))}function a(e){return Object(i.c)(e,c)}function o(e){Object(i.e)(e.id,e,c)}function s(e){return Object(i.b)(e,c).then((()=>!0))}function l(e,t){return"last-accessed"===e?Math.max(t.accessedAt||0,t.createdAt):"file-size"===e?t.size:"file-name"===e?t.name.toLowerCase().replace(/[^\w\s]/gi,""):void 0}function d(e,{sortBy:t,sortOrder:n}){return"last-accessed"===t?function(e,t,n){const[i,c]=e.reduce(((e,t)=>("reading"===t.status?e[0].push(t):e[1].push(t),e)),[[],[]]);return u(i,t,n).concat(u(c,t,n))}(e,t,-n):u(e,t,n)}function u(e,t,n){return[...e].sort(((e,i)=>{const c=l(t,e),r=l(t,i);return c<r?-n:c>r?n:0}))}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t){},function(e,t,n){"use strict";var i=n(3),c=(n(0),n(13));n(43);t.a=function({file:e,showLink:t,children:n}){return Object(i.jsxs)("li",{className:"file-card",children:[t?Object(i.jsx)(c.b,{to:"/viewer/"+e.id,className:"file-card-left",title:"Open "+e.name,children:Object(i.jsx)("img",{src:e.coverImage,className:"file-card-image",alt:""})}):Object(i.jsx)("img",{src:e.coverImage,className:"file-card-left file-card-image",alt:""}),Object(i.jsxs)("div",{className:"file-card-info",children:[Object(i.jsx)("div",{className:"file-card-title",children:e.title||e.name}),e.author&&Object(i.jsx)("div",{className:"file-card-author",children:e.author}),Object(i.jsxs)("div",{className:"file-card-secondary-info",children:[e.title&&Object(i.jsx)("div",{className:"file-card-secondary-info-item file-card-filename",children:e.name}),Object(i.jsx)("div",{className:"file-card-secondary-info-item",children:e.sizeString})]}),Object(i.jsx)("div",{className:"file-card-progress-container",title:`${e.pageNumber} of ${e.pageCount} page${1===e.pageCount?"":"s"} read`,children:Object(i.jsx)("div",{className:"file-card-progress",children:Object(i.jsx)("div",{className:"file-card-progress-bar",style:{left:(e.pageNumber-1)/e.pageCount*100+"%"}})})}),Object(i.jsx)("div",{className:"file-card-bottom",children:n})]})]})}},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){"use strict";var i="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),c=new Uint8Array(16);function r(){if(!i)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(c)}var a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var o=function(e){return"string"===typeof e&&a.test(e)},s=[],l=0;l<256;++l)s.push((l+256).toString(16).substr(1));var d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase();if(!o(n))throw TypeError("Stringified UUID is invalid");return n};t.a=function(e,t,n){var i=(e=e||{}).random||(e.rng||r)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var c=0;c<16;++c)t[n+c]=i[c];return t}return d(i)}},,function(e,t,n){"use strict";n.r(t);var i=n(3),c=n(0),r=n(1),a=n(57),o=n(72),s=n(32),l=n(40),d=n(38);const u=new d.a("ModestKeep2","current-file");function f(){return Object(d.c)("file",u)}var b=n(34);class m{constructor(e,t,n){this.pdfDocument=e,this.pdfElement=t,this.url=n}navigateTo(e){this.goToDestination(e)}async goToDestination(e){let t=null;t="string"===typeof e?await this.pdfDocument.getDestination(e):e;const n=await this.pdfDocument.getPageIndex(t[0]);Object(s.h)(n+1,this.pdfElement.children,Object(b.a)("keepToolbarVisible"))}getDestinationHash(e){if("string"===typeof e&&e.length)return this.getAnchorUrl("#"+escape(e));if(Array.isArray(e)){const t=JSON.stringify(e);if(t.length)return this.getAnchorUrl("#"+escape(t))}return this.getAnchorUrl("")}getAnchorUrl(e){return this.url+e}}var h=n(31),v=n(13),j=n(37),p=n(33),g=n(45);n(65);var w=function({file:e,notification:t,dismissNotification:n,handleFileUpload:c,loadPreviewFile:r}){return Object(i.jsxs)("div",{className:"viewer-file-preview-container",children:[Object(i.jsx)(p.a,{}),Object(i.jsxs)("div",{className:"viewer-file-preview",children:["negative"===(null===t||void 0===t?void 0:t.type)&&Object(i.jsx)(j.a,{notification:t,margin:"bottom",dismiss:n}),Object(i.jsxs)(g.a,{file:e,children:[Object(i.jsx)(v.b,{to:"/",className:"btn icon-btn",title:"Back to files",children:Object(i.jsx)(h.a,{name:"bookshelf",size:"24px"})}),Object(i.jsxs)("label",{className:"btn viewer-file-preview-import-btn",children:[Object(i.jsx)("input",{type:"file",onChange:c,className:"sr-only",accept:"application/pdf"}),Object(i.jsx)("span",{children:"Select File"})]})]}),"warning"===(null===t||void 0===t?void 0:t.type)&&Object(i.jsxs)("div",{className:"viewer-file-preview-warning",children:[Object(i.jsxs)("div",{className:"viewer-file-preview-warning-main",children:[Object(i.jsx)(h.a,{name:"info",className:"viewer-file-preview-warning-icon",size:"24px"}),Object(i.jsx)("p",{className:"viewer-file-preview-warning-message",children:t.value})]}),Object(i.jsxs)("div",{className:"viewer-file-preview-warning-bottom",children:[Object(i.jsx)("button",{className:"btn text-btn viewer-file-preview-warning-btn",onClick:n,children:"No"}),Object(i.jsx)("button",{className:"btn viewer-file-preview-warning-btn",onClick:r,children:"Yes"})]})]})]})]})},O=n(36);n(66);var x=function({file:e}){return Object(i.jsxs)(O.a,{toggle:{content:Object(i.jsx)(h.a,{name:"info"}),title:"Information",className:"btn icon-btn icon-btn-alt"},body:{className:"file-info"},children:[Object(i.jsx)("img",{src:e.coverImage,className:"file-info-image",alt:""}),Object(i.jsxs)("div",{children:[Object(i.jsxs)("div",{className:"file-info-details-item",children:[Object(i.jsx)("span",{children:"File name:"}),Object(i.jsx)("span",{children:e.name})]}),Object(i.jsxs)("div",{className:"file-info-details-item",children:[Object(i.jsx)("span",{children:"File size:"}),Object(i.jsx)("span",{children:e.sizeString})]}),Object(i.jsxs)("div",{className:"file-info-details-item",children:[Object(i.jsx)("span",{children:"Title: "}),Object(i.jsx)("span",{children:e.title||"-"})]}),Object(i.jsxs)("div",{className:"file-info-details-item",children:[Object(i.jsx)("span",{children:"Author:"}),Object(i.jsx)("span",{children:e.author||"-"})]}),Object(i.jsxs)("div",{className:"file-info-details-item",children:[Object(i.jsx)("span",{children:"Page count:"}),Object(i.jsx)("span",{children:e.pageCount})]})]})]})};n(67);var L=function({file:e,preferences:t,outline:n,toggleOutline:r,zoomOut:a,zoomIn:o,previousPage:s,nextPage:l,rotatePages:d,handleSelect:u,scrollToNewPage:f,updateSettings:m,updateSaveFilePreference:v,changeViewMode:j,handleFileUpload:p,exitViewer:g}){const[w,L]=Object(c.useState)((()=>Object(b.b)())),[N,C]=Object(c.useState)(e.pageNumber),y=Object(c.useRef)(!1),M=Object(c.useRef)(e.scrollTop>0),V=Object(c.useRef)(null),k=Object(c.useRef)(0),H=Object(c.useRef)(!1),A=Object(c.useRef)(!1),E=Object(c.useCallback)((function(){if(H.current)return;H.current=!0,requestAnimationFrame((()=>{const{scrollTop:t}=document.documentElement;if(t>e.scrollTop)y.current?y.current=!1:F();else if(!t||k.current>100)T();else{const n=e.scrollTop-t;k.current+=n}H.current=!1}))}),[e]),S=Object(c.useCallback)((function(){if(H.current)return;H.current=!0,requestAnimationFrame((()=>{const{scrollTop:e}=document.documentElement;e<80?"multi"===t.viewMode&&T():M.current?F():"multi"===t.viewMode&&T(),H.current=!1}))}),[t.viewMode]);function T(){var e;(null===(e=V.current)||void 0===e?void 0:e.classList.contains("hidden"))&&(k.current=0,V.current.classList.remove("hidden"),setTimeout((()=>{V.current.classList.remove("hiding")}),200))}function F(){var e;(null===(e=V.current)||void 0===e?void 0:e.classList.contains("hidden"))||(k.current=0,V.current.classList.add("hiding"),setTimeout((()=>{V.current.classList.add("hidden")}),200))}function D(e){A.current||(A.current=!0,requestAnimationFrame((()=>{e.clientY<80&&e.clientX<document.documentElement.clientWidth&&V.current.classList.contains("hidden")&&(V.current.classList.remove("hidden"),setTimeout((()=>{V.current.classList.remove("hiding")}),200)),A.current=!1})))}function Z({target:e}){const{scrollTop:n}=document.documentElement;if(!e.closest(".viewer-toolbar")&&!e.closest(".btn")){if(y.current=!1,"multi"===t.viewMode&&n<40)return void(M.current=!M.current);V.current.classList.contains("hidden")?(M.current=!1,T()):(M.current=!0,F())}}function P({target:e}){m(e.name,e.checked),L({...w,[e.name]:e.checked}),Object(b.c)(e.name,e.checked)}return Object(c.useEffect)((()=>matchMedia("only screen and (hover: none) and (pointer: coarse)").matches?(V.current.classList.toggle("hiding",e.scrollTop>0),V.current.classList.toggle("hidden",e.scrollTop>0),window.addEventListener("pointerup",Z),window.addEventListener("scroll",S),()=>{window.removeEventListener("pointerup",Z),window.removeEventListener("scroll",S)}):(window.addEventListener("scroll",E),window.addEventListener("mousemove",D),()=>{window.removeEventListener("scroll",E),window.removeEventListener("mousemove",D)})),[E,S]),Object(c.useEffect)((()=>{C(e.pageNumber)}),[e.pageNumber]),Object(i.jsxs)("div",{className:"viewer-toolbar"+(w.keepToolbarVisible?" keep-visible":""),ref:V,children:[Object(i.jsx)(x,{file:e}),n.hasOutline?Object(i.jsx)("button",{className:"btn icon-btn viewer-outline-toggle-btn",onClick:r,title:"Toggle outline",children:Object(i.jsx)(h.a,{name:"outline"})}):null,Object(i.jsxs)("div",{className:"viewer-toolbar-tools",children:[Object(i.jsxs)("div",{className:"viewer-toolbar-zoom",children:[Object(i.jsx)("button",{className:"btn icon-btn viewer-toolbar-tool-btn",onClick:a,title:"Zoom out",disabled:e.scale.currentScale<=e.scale.minScale,children:Object(i.jsx)(h.a,{name:"minus"})}),Object(i.jsxs)("select",{className:"input viewer-toolbar-zoom-select",onChange:u,value:e.scale.name,children:[Object(i.jsxs)("option",{value:"custom",style:{display:"none"},children:[e.scale.displayValue,"%"]}),Object(i.jsx)("option",{value:"fit-width",children:"Fit Width"}),Object(i.jsx)("option",{value:"fit-page",children:"Fit Page"}),Object(i.jsx)("option",{value:"0.5",children:"50%"}),Object(i.jsx)("option",{value:"0.75",children:"75%"}),Object(i.jsx)("option",{value:"1",children:"100%"}),Object(i.jsx)("option",{value:"1.5",children:"150%"}),Object(i.jsx)("option",{value:"2",children:"200%"}),Object(i.jsx)("option",{value:"3",children:"300%"}),Object(i.jsx)("option",{value:"4",children:"400%"})]}),Object(i.jsx)("button",{className:"btn icon-btn viewer-toolbar-tool-btn",onClick:o,title:"Zoom in",disabled:e.scale.currentScale>=e.scale.maxScale,children:Object(i.jsx)(h.a,{name:"plus"})})]}),Object(i.jsxs)("div",{className:"viewer-toolbar-page",children:[Object(i.jsx)("button",{className:"btn icon-btn viewer-toolbar-tool-btn",onClick:function(){y.current=!0,s()},disabled:e.pageNumber<=1,children:Object(i.jsx)(h.a,{name:"arrow-up"})}),Object(i.jsxs)("div",{className:"viewer-toolbar-page-input-container",onClick:function(e){e.target!==e.currentTarget.firstElementChild&&e.currentTarget.firstElementChild.focus()},children:[Object(i.jsx)("input",{type:"text",inputMode:"numeric",className:"input viewer-toolbar-page-input",onChange:function(e){C(e.target.value)},value:N,onBlur:function(t){let n=parseInt(t.target.value,10);Number.isNaN(n)?n=e.pageNumber:n<1?n=1:n>e.pageCount&&(n=e.pageCount),t.target.style.width=n.toString().length+"ch",n!==e.pageNumber&&(y.current=!0,f(n)),C(n)},onFocus:function(t){const{pageCount:n}=e,i=n<1e3?3:n.toString().length;t.target.style.width=i+"ch",t.target.select()},onKeyDown:function(e){"Enter"===e.key&&e.target.blur()},style:{width:e.pageNumber.toString().length+"ch"}}),Object(i.jsxs)("div",{children:["of ",e.pageCount]})]}),Object(i.jsx)("button",{className:"btn icon-btn viewer-toolbar-tool-btn",onClick:function(){y.current=!0,l()},disabled:e.pageNumber>=e.pageCount,children:Object(i.jsx)(h.a,{name:"arrow-down"})})]})]}),Object(i.jsxs)(O.a,{container:{className:"viewer-toolbar-dropdown-container"},toggle:{content:Object(i.jsx)(h.a,{name:"dots-vertical"}),title:"More",className:"btn icon-btn icon-btn-alt"},body:{className:"viewer-toolbar-dropdown"},children:[Object(i.jsx)("div",{className:"viewer-toolbar-dropdown-group",children:Object(i.jsxs)("label",{className:"btn icon-text-btn dropdown-btn viewer-toolbar-dropdown-btn",children:[Object(i.jsx)(h.a,{name:"upload"}),Object(i.jsx)("span",{children:"Load File"}),Object(i.jsx)("input",{type:"file",onChange:p,className:"sr-only",accept:"application/pdf"})]})}),Object(i.jsx)("div",{className:"viewer-toolbar-dropdown-group",children:Object(i.jsxs)("button",{className:"btn icon-text-btn dropdown-btn viewer-toolbar-dropdown-btn",onClick:d,children:[Object(i.jsx)(h.a,{name:"rotate"}),Object(i.jsx)("span",{children:"Rotate pages"})]})}),Object(i.jsxs)("div",{className:"viewer-toolbar-dropdown-group",children:[Object(i.jsxs)("button",{className:"btn icon-text-btn dropdown-btn viewer-toolbar-dropdown-btn viewer-view-mode-btn"+("multi"===t.viewMode?" active":""),onClick:()=>j("multi"),children:[Object(i.jsx)(h.a,{name:"pages"}),Object(i.jsx)("span",{children:"Multi page"})]}),Object(i.jsxs)("button",{className:"btn icon-text-btn dropdown-btn viewer-toolbar-dropdown-btn viewer-view-mode-btn"+("single"===t.viewMode?" active":""),onClick:()=>j("single"),children:[Object(i.jsx)(h.a,{name:"page"}),Object(i.jsx)("span",{children:"Single page"})]})]}),Object(i.jsxs)("div",{className:"viewer-toolbar-dropdown-group viewer-toolbar-settings",children:[Object(i.jsxs)("label",{className:"viewer-toolbar-settings-item",children:[Object(i.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input",name:"invertColors",onChange:P,checked:w.invertColors}),Object(i.jsx)("div",{className:"checkbox",children:Object(i.jsx)("div",{className:"checkbox-tick"})}),Object(i.jsx)("span",{className:"checkbox-label",children:"Invert page colors."})]}),Object(i.jsxs)("label",{className:"viewer-toolbar-settings-item",children:[Object(i.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input",name:"keepToolbarVisible",onChange:P,checked:w.keepToolbarVisible}),Object(i.jsx)("div",{className:"checkbox",children:Object(i.jsx)("div",{className:"checkbox-tick"})}),Object(i.jsx)("span",{className:"checkbox-label",children:"Keep toolbar visible."})]}),t.hideWarning&&Object(i.jsxs)("label",{className:"viewer-toolbar-settings-item",children:[Object(i.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input",onChange:v,checked:t.saveLoadedFile}),Object(i.jsx)("div",{className:"checkbox",children:Object(i.jsx)("div",{className:"checkbox-tick"})}),Object(i.jsx)("span",{className:"checkbox-label",children:"Save loaded file."})]})]}),Object(i.jsxs)("button",{className:"btn icon-text-btn viewer-toolbar-dropdown-btn",onClick:function(){window.removeEventListener("scroll",E),window.removeEventListener("mousemove",D),g()},title:"Exit",children:[Object(i.jsx)(h.a,{name:"exit"}),Object(i.jsx)("span",{children:"Exit Viewer"})]})]})]})};n(68);var N=function({message:e,preferences:t,saveFileLoadModalFile:n,hideFileLoadModal:r,hideFileLoadMessage:a,dismissNotification:o}){const[s,l]=Object(c.useState)(!1),d=Object(c.useRef)(0);function u(e){const i={...t,hideWarning:s,saveLoadedFile:e};e?n(i):r(i),s&&function(e){localStorage.setItem("viewer-preferences",JSON.stringify(e))}(i)}return Object(c.useEffect)((()=>{if(clearTimeout(d.current),e.duration)return d.current=setTimeout((()=>{a()}),e.duration),()=>{clearTimeout(d.current)}}),[e]),"negative"===e.type?Object(i.jsx)(j.a,{notification:e,className:"viewer-file-load-modal viewer-notification",dismiss:o}):"warning"!==e.type||t.hideWarning?null:Object(i.jsxs)("div",{className:"viewer-file-load-modal viewer-file-load-warning",children:[Object(i.jsxs)("div",{className:"viewer-file-load-warning-mesasge-container",children:[Object(i.jsx)(h.a,{name:"info",size:"24px"}),Object(i.jsx)("p",{className:"viewer-file-load-warning-mesasge",children:e.value})]}),Object(i.jsxs)("label",{className:"checkbox-container viewer-file-load-warning-checkbox-container",children:[Object(i.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input",onChange:function({target:e}){l(e.checked)},checked:s}),Object(i.jsx)("div",{className:"checkbox",children:Object(i.jsx)("div",{className:"checkbox-tick"})}),Object(i.jsx)("span",{className:"checkbox-label",children:"Don't show this message again."})]}),Object(i.jsxs)("div",{className:"viewer-file-load-warning-bottom",children:[Object(i.jsx)("button",{className:"btn text-btn",onClick:function(){u(!1)},children:"No"}),Object(i.jsx)("button",{className:"btn viewer-file-load-warning-btn",onClick:function(){u(!0)},children:"Yes"})]})]})};n(69);var C=function(){return Object(i.jsxs)("div",{className:"no-file-notice",children:[Object(i.jsx)(p.a,{}),Object(i.jsx)("p",{className:"no-file-notice-message",children:"File not found."}),Object(i.jsxs)(v.b,{to:"/",className:"btn icon-text-btn primary-btn",children:[Object(i.jsx)(h.a,{name:"bookshelf",size:"24px"}),Object(i.jsx)("span",{children:"Back to Files"})]})]})};n(70);t.default=function(){const e=Object(r.f)(),{id:t}=Object(r.g)(),[n,v]=Object(c.useState)(null),[j,p]=Object(c.useState)(1),[g,O]=Object(c.useState)((()=>({name:"1",currentScale:1.3333,initialScale:1.3333,minScale:.333325,maxScale:13.333}))),[x,y]=Object(c.useState)(0),[M,V]=Object(c.useState)(null),[k,H]=Object(c.useState)((()=>Object(b.b)())),[A,E]=Object(c.useState)((()=>function(){const e=JSON.parse(localStorage.getItem("viewer-preferences"))||{saveFile:!0,viewMode:"multi"};e.viewMode||(e.viewMode="multi");return e.saveFile=!0,e}())),[S,T]=Object(c.useState)({visible:!1}),F=Object(c.useRef)(null),D=Object(c.useRef)(null),Z=Object(c.useRef)(!1),P=Object(c.useRef)([]),R=Object(c.useRef)(null),I=Object(c.useRef)(0),z=Object(c.useRef)(!1),B=Object(c.useRef)(!1),W=Object(c.useRef)(0),U=Object(c.useRef)(!1),$=Object(c.useRef)(!0),J=Object(c.useRef)(!1),K=Object(c.useCallback)((function(){if(z.current)return;z.current=!0,requestAnimationFrame((()=>{const{scrollTop:e,scrollLeft:t}=document.documentElement,i=n.file.pageNumber;W.current=e>n.file.scrollTop?1:-1,n.file.scrollTop=e<0?0:e,n.file.scrollLeft=t,n.file.pageNumber=function(e,t){for(let n=0;n<e.length-1;n+=1){const i=e[n],c=e[n+1],r=i.top+i.height/2,a=c.top+c.height/2;if(t>=r&&t<=a)return n+2}return 1}(n.views,n.file.scrollTop),A.saveFile&&(clearTimeout(I.current),I.current=setTimeout((()=>{Object(l.d)(n.file)}),1e3)),n.file.pageNumber!==i&&(p(n.file.pageNumber),v({...n})),z.current=!1}))}),[g,x,A]),q=Object(c.useCallback)((function(){if(z.current)return;z.current=!0,requestAnimationFrame((()=>{const{scrollTop:e,scrollLeft:t}=document.documentElement;n.file.scrollTop=e<0?0:e,n.file.scrollLeft=t,A.saveFile&&(clearTimeout(I.current),I.current=setTimeout((()=>{Object(l.d)(n.file)}),1e3)),v({...n}),z.current=!1}))}),[j,x,A]),_=Object(c.useCallback)((async function(e){"A"===e.target.nodeName&&ie(e.target.href)}),[n,A]),Y=Object(c.useCallback)((function(e){U.current&&(e.preventDefault(),e.wheelDelta>0?pe():je())}),[g]),G=Object(c.useCallback)((function(e){U.current=e.ctrlKey}),[g]),X=Object(c.useCallback)((function(e){if("INPUT"===e.target.nodeName)return;if(U.current=e.ctrlKey,e.ctrlKey)return"+"===e.key&&(pe(),e.preventDefault()),void("-"===e.key&&(je(),e.preventDefault()));const{scrollWidth:t,offsetWidth:n}=document.documentElement;t<=n&&("ArrowLeft"===e.key?(ge(),e.preventDefault()):"ArrowRight"===e.key&&(we(),e.preventDefault()))}),[g,j]),Q=Object(c.useCallback)((function(e){if(e.preventDefault(),e.dataTransfer.files.length){const[t]=e.dataTransfer.files;be(t)}}),[n]);function ee(e,t){const{width:n,height:i}=te(e-1,t),c=F.current.firstElementChild;if(c.style.width=n+"px",c.style.height=i+"px",c.hasAttribute("data-loaded")){const e=c.firstElementChild;e.style.width=n+"px",e.style.height=i+"px",c.setAttribute("data-rerender-needed",!0)}}function te(e,t){const i=n.pageDimensions[e];let c=Math.floor(i.width*t),r=Math.floor(i.height*t);return J.current&&([c,r]=[r,c]),{width:c,height:r}}async function ne(e){const t=parseInt(e.getAttribute("data-page-number"),10),{width:i,height:c}=te(t-1,g.currentScale),r=document.createElement("canvas");let o=null,s=null;r.classList.add("viewer-page-canvas"),e.hasAttribute("data-rerender-needed")?([s,o]=e.children,o.innerHTML="",e.removeAttribute("data-rerender-needed")):(o=document.createElement("div"),o.classList.add("viewer-page-text"),e.appendChild(r),e.appendChild(o));const l=await n.instance.getPage(t),d=l.getViewport({scale:g.currentScale,rotation:(x+l.rotate)%360});if(r.width=i,r.height=c,o.style.width=i+"px",o.style.height=c+"px",await l.render({canvasContext:r.getContext("2d"),enableWebGL:!0,viewport:d}).promise,requestAnimationFrame((async()=>{a.renderTextLayer({textContent:await l.getTextContent(),container:o,viewport:d,textDivs:[]}),async function(e,t,i){const c=await t.getAnnotations(),r=i.children[2];if(!c.length)return void(r&&r.remove());const o={page:t,annotations:c,viewport:e.clone({dontFlip:!0}),div:r,linkService:new m(n.instance,F.current,window.location.href)};if(r&&"multi"===A.viewMode)a.AnnotationLayer.update(o);else{const e=document.createElement("div");e.className="viewer-annotation-layer",i.appendChild(e),o.div=e,a.AnnotationLayer.render(o),r&&r.remove()}}(d,l,e)})),s&&e.replaceChild(r,s),P.current.length)for(;P.current.length;){const e=1===W.current?P.current.pop():P.current.shift();e.setAttribute("data-loaded","true"),ne(e)}else Z.current=!1}async function ie(e){const t=new URL(e);if(t.origin!==window.location.origin)return;const i=t.hash.split("#"),c=unescape(i[i.length-1]);let r="";try{r=JSON.parse(c)}catch{r=await n.instance.getDestination(c)}const a=await n.instance.getPageIndex(r[0]);"single"===A.viewMode?p(a+1):Object(s.h)(a+1,F.current.children,k.keepToolbarVisible)}function ce(e){e.preventDefault()}async function re(e,{pageNumber:t,scale:n={currentScale:1},rotation:i=0}){return(await e.getPage(t)).getViewport({scale:n.currentScale,rotation:i})}async function ae(e,t){const n=[];for(let i=0;i<e.numPages;i+=1){const{width:c,height:r}=await re(e,{pageNumber:i+1,rotation:t});n.push({width:c,height:r})}return n}async function oe(e,t){const{width:n,height:i}=await re(e,t),c=document.createElement("div");return c.style.width=Math.floor(n)+"px",c.style.height=Math.floor(i)+"px",c.setAttribute("data-page-number",t.pageNumber),c.classList.add("viewer-page"),c}async function se(e,t,n,i){const c=await oe(i,{...t,pageNumber:e});n.appendChild(c)}async function le(e,t,n){const i=await oe(e,t);n&&i.classList.add("hidden"),F.current.appendChild(i)}async function de(e,t){const n=new DocumentFragment,i=[];for(let c=0;c<e.numPages;c+=1)i.push(se(c+1,t,n,e));await Promise.all(i),F.current.appendChild(n)}async function ue(e,{save:t=!0,fileMetadata:i=null,pdfInstance:c=null}={}){i.scale=i.scale||{name:"1",currentScale:1.3333,initialScale:1.3333,minScale:.333325,maxScale:13.333},i.pageNumber=i.pageNumber||1,i.rotation=i.rotation||0;const r=c||await Object(s.d)(e,a),[o,l]=await Promise.all([ae(r,i.rotation),r.getOutline(),"multi"===A.viewMode?de(r,i):le(r,i,!0)]);null===n||void 0===n||delete n.filePreviewVisible,J.current=!1,y(i.rotation),v({...n,instance:r,pageDimensions:o,file:i}),window.scrollTo(i.scrollLeft,i.scrollTop),O(i.scale),p(i.pageNumber),T({...S,hasOutline:l}),"have read"!==i.status&&(1===i.pageCount?i.status="have read":i.status="reading"),i.accessedAt=Date.now(),t&&me(e,i)}async function fe({file:t,save:n=!0}){let i=await async function(e){return(await Object(l.c)()).find((({name:t})=>t===e.name))}(t),c=null;if(!i){c=await Object(s.d)(t,a);const[e,r]=await Promise.all([c.getMetadata(),Object(s.f)(c)]);i={...Object(s.g)(e),id:Object(o.a)(),name:t.name,createdAt:Date.now(),scale:{name:"1",currentScale:1.3333,initialScale:1.3333,minScale:.333325,maxScale:13.333},pageCount:c.numPages,coverImage:r},M||(n=!!A.hideWarning&&A.saveLoadedFile,A.hideWarning||V({file:t,type:"warning",value:"Do you want to save this file?"}))}E({...A,saveFile:n}),ue(t,{fileMetadata:i,save:n,pdf:c}),e.replace({pathname:"/viewer/"+i.id,state:!0}),Object(s.i)(i.name)}async function be(e){e.name.endsWith(".pdf")?e.name===n.file.name?n.filePreviewVisible?(ue(e,{fileMetadata:n.file}),xe()):V({type:"negative",value:"File is already loaded.",duration:4e3}):n.filePreviewVisible?V({file:e,type:"warning",value:"File does not match currently loaded file.\nDo you want to load it anyway?"}):($.current=!0,F.current.innerHTML="",D.current.innerHTML="",T({visible:!1}),fe({file:e}),window.removeEventListener("scroll",K)):V({type:"negative",value:"File format is not supported.",duration:4e3})}function me(e,t){Object(l.d)(t),async function(e){const t=await f();(null===t||void 0===t?void 0:t.name)!==e.name&&Object(d.e)("file",e,u)}(e)}function he(e){e.saveFile=e.saveLoadedFile,xe(),E(e)}function ve(e){const[t]=e.target.files;be(t),e.target.value=""}function je(){const e=Math.max(g.currentScale/1.1,g.minScale);B.current=!0,O({...g,name:"custom",currentScale:e,displayValue:Math.round(100*e/g.initialScale)})}function pe(){const e=Math.min(1.1*g.currentScale,g.maxScale);B.current=!0,O({...g,name:"custom",currentScale:e,displayValue:Math.round(100*e/g.initialScale)})}function ge(){"single"===A.viewMode?p(j-1):Object(s.h)(j-1,F.current.children,k.keepToolbarVisible)}function we(){"single"===A.viewMode?p(j+1):Object(s.h)(j+1,F.current.children,k.keepToolbarVisible)}function Oe(e){Object(s.h)(e,F.current.children,k.keepToolbarVisible),p(e)}function xe(){V(null)}function Le(e){localStorage.setItem("viewer-preferences",JSON.stringify(e))}function Ne(e,t){const i=new DocumentFragment,c=new m(n.instance,F.current,window.location.href);for(const n of e){const e=document.createElement("div"),t=document.createElement("a");if(e.classList.add("viewer-outline-item"),t.classList.add("viewer-outline-link"),t.textContent=n.title,t.href=c.getDestinationHash(n.dest),n.items.length){const t=document.createElement("button");t.innerHTML="&#x25BE",t.classList.add("btn","icon-btn","viewer-outline-tree-toggle-btn"),e.appendChild(t)}if(e.appendChild(t),n.items.length){const t=document.createElement("div");t.classList.add("viewer-outline-inner-tree"),Ne(n.items,t),e.appendChild(t)}i.appendChild(e)}t.appendChild(i)}return Object(c.useEffect)((()=>(async function(){if(e.location.state)return;const n=await Object(l.b)(t);if(n){var i;const e=await f();(null===(i=n.scale)||void 0===i?void 0:i.value)&&(n.scale={name:"1",currentScale:1.3333,initialScale:1.3333,minScale:.333325,maxScale:13.333,name:n.scale.name,currentScale:n.scale.value}),e&&e.name===n.name?ue(e,{fileMetadata:n}):v({file:n,filePreviewVisible:!0}),Object(s.i)(n.name),document.body.style.overscrollBehavior="none"}else v({error:!0}),Object(s.i)("Error")}(),()=>{document.body.style.overscrollBehavior=""})),[t]),Object(c.useEffect)((()=>{if(n&&n.instance)return window.addEventListener("wheel",Y,{passive:!1}),window.addEventListener("keyup",G),()=>{window.removeEventListener("wheel",Y,{passive:!1}),window.removeEventListener("keyup",G)}}),[Y,G]),Object(c.useEffect)((()=>(window.addEventListener("keydown",X),()=>{window.removeEventListener("keydown",X)})),[X]),Object(c.useEffect)((()=>{if(n&&n.instance){if("single"!==A.viewMode)return window.addEventListener("scroll",K),()=>{window.removeEventListener("scroll",K)};window.removeEventListener("scroll",K)}}),[K]),Object(c.useEffect)((()=>{if(n&&n.instance){if("multi"!==A.viewMode)return window.addEventListener("scroll",q),()=>{window.removeEventListener("scroll",q)};window.removeEventListener("scroll",q)}}),[q]),Object(c.useEffect)((()=>{if(n&&n.instance){if("multi"!==A.viewMode)return window.addEventListener("click",_),()=>{window.removeEventListener("click",_)};window.removeEventListener("click",_)}}),[_]),Object(c.useEffect)((()=>(window.addEventListener("drop",Q),window.addEventListener("dragover",ce),()=>{window.removeEventListener("drop",Q),window.removeEventListener("dragover",ce)})),[Q]),Object(c.useEffect)((()=>{n&&n.instance&&"single"!==A.viewMode&&(!function(e){const{scrollLeft:t}=document.documentElement,{top:i}=Object(s.c)(j,F.current.children),c=e.currentScale,r=c/n.file.scale.currentScale;!function(e){for(const[t,n]of Object.entries(F.current.children)){const{width:i,height:c}=te(t,e);if(n.style.width=i+"px",n.style.height=c+"px",n.hasAttribute("data-loaded")){const e=n.firstElementChild,{width:t}=e;i===t?(e.style.width="",e.style.height="",n.removeAttribute("data-rerender-needed")):(e.style.width=i+"px",e.style.height=c+"px",n.setAttribute("data-rerender-needed",!0))}}}(c),n.file.scale=e,n.views=Array.from(F.current.children).map((e=>({top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}))),n.pagesInViewport=function(e){if(e.length<2)return 1;const t=Math.ceil(document.documentElement.offsetHeight/((e[0].height+e[1].height)/2));if(t<2)return 2;return t}(n.views),x!==n.file.rotation?(n.file.rotation=x,Object(s.h)(j,F.current.children,k.keepToolbarVisible)):(n.file.scrollTop=n.views[j-1].top-i*r,n.file.scrollLeft=t*r,window.scrollTo(n.file.scrollLeft,n.file.scrollTop)),v({...n}),!$.current&&A.saveFile&&Object(l.d)(n.file)}(g),R.current&&R.current.disconnect(),R.current=new IntersectionObserver((function(e){e.forEach((({isIntersecting:e,target:t})=>{!e||t.hasAttribute("data-loaded")&&!t.hasAttribute("data-rerender-needed")||(Z.current?P.current.push(t):(Z.current=!0,t.setAttribute("data-loaded","true"),ne(t)))}))}),{rootMargin:"200px 0px"}),Array.from(F.current.children).forEach((e=>{R.current.observe(e)})),B.current=!1,$.current=!1)}),[g,x,j,A.viewMode]),Object(c.useEffect)((()=>{if("single"===A.viewMode){if(matchMedia("only screen and (hover: none) and (pointer: coarse)").matches&&!k.keepToolbarVisible)return void F.current.classList.remove("offset")}F.current.classList.add("offset")}),[A.viewMode,k.keepToolbarVisible]),Object(c.useEffect)((()=>{n&&n.instance&&"multi"!==A.viewMode&&($.current?$.current=!1:async function(){const e=F.current.firstElementChild;e.classList.contains("hidden")&&(e.classList.remove("hidden"),window.scrollTo(n.file.scrollLeft,n.file.scrollTop));e.setAttribute("data-page-number",j),ee(j,g.currentScale),await ne(e),e.setAttribute("data-loaded","true"),j!==n.file.pageNumber&&window.scrollTo(0,0);n.file.scale=g,n.file.rotation=x,n.file.pageNumber=j,v({...n}),A.saveFile&&Object(l.d)(n.file)}())}),[g,x,j,A.viewMode]),(null===n||void 0===n?void 0:n.error)?Object(i.jsx)(C,{}):Object(i.jsxs)(i.Fragment,{children:[(null===n||void 0===n?void 0:n.filePreviewVisible)&&Object(i.jsx)(w,{file:n.file,notification:M,dismissNotification:xe,handleFileUpload:ve,loadPreviewFile:function(){fe(M),xe()}}),(null===n||void 0===n?void 0:n.instance)&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(L,{file:n.file,preferences:A,outline:S,toggleOutline:async function(){if(!S.rendered){const e=await n.instance.getOutline();e&&Ne(e,D.current),S.rendered=!0}T({...S,visible:!S.visible})},zoomOut:je,zoomIn:pe,previousPage:ge,nextPage:we,rotatePages:function(){const e=x+90;J.current=!J.current,y(360===e?0:e)},handleSelect:async function({target:e}){const{value:t}=e;let i=0;if("fit-width"===t){const e="single"===A.viewMode,{offsetWidth:t,scrollHeight:c,offsetHeight:r}=document.documentElement,{width:a}=await re(n.instance,{pageNumber:j,rotation:x});let o=0;90!==x&&270!==x||(o=e&&c>r?-Object(s.e)():0);i=(t-o-16)/a}else if("fit-page"===t){const e="single"===A.viewMode,{scrollWidth:t,offsetWidth:c,offsetHeight:r}=document.documentElement,{height:a}=await re(n.instance,{pageNumber:j,rotation:x});let o=0;90!==x&&270!==x||(o=e&&t>c?0:-Object(s.e)());const{keepToolbarVisible:l}=k;i=(r+o-(l||1===j||e?56:16))/a}else i=g.initialScale*t;B.current=!0,O({...g,name:t,currentScale:i})},scrollToNewPage:Oe,updateSettings:function(e,t){H({...k,[e]:t})},updateSaveFilePreference:function({target:e}){const t={...A,saveLoadedFile:e.checked};E(t),Le(t)},changeViewMode:async function(e){const t={...A,viewMode:e};F.current.innerHTML="","multi"===e?(await de(n.instance,n.file),Oe(j)):(window.removeEventListener("scroll",K),await le(n.instance,n.file),ee(j,g.currentScale),await ne(F.current.firstElementChild),F.current.firstElementChild.setAttribute("data-loaded","true"),window.scrollTo(0,0)),E(t),Le(t)},handleFileUpload:ve,exitViewer:function(){window.removeEventListener("scroll",K),e.push({pathname:"/"})}}),M&&Object(i.jsx)(N,{message:M,preferences:A,saveFileLoadModalFile:function(e){me(M.file,n.file),he(e)},hideFileLoadModal:he,hideFileLoadMessage:xe,dismissNotification:xe})]}),Object(i.jsx)("div",{className:"viewer-pdf offset"+(k.invertColors?" invert":""),ref:F}),Object(i.jsx)("div",{className:"viewer-outline"+(S.visible?" visible":""),ref:D,onClick:function(e){const{nodeName:t}=e.target;"A"===t?(e.preventDefault(),ie(e.target.href)):"BUTTON"===t&&(e.target.classList.toggle("rotated"),e.target.parentElement.lastElementChild.classList.toggle("visible"))}}),"single"===A.viewMode&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("button",{className:"btn icon-btn viewer-navigation-btn previous",onClick:ge,children:Object(i.jsx)(h.a,{name:"chevron-left"})}),Object(i.jsx)("button",{className:"btn icon-btn viewer-navigation-btn next",onClick:we,children:Object(i.jsx)(h.a,{name:"chevron-right"})})]})]})}}])]);